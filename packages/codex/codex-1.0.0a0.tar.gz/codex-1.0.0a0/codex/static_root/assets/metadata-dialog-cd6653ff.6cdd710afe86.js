import{_ as j,o as _,d as $,ax as Me,r as oe,w as B,ay as Ne,az as Q,aq as Ye,bb as Ge,bc as He,bd as We,S as Ke,be as E,bf as k,ag as Z,bg as Je,bh as Xe,bi as ke,N as fe,bj as Qe,af as Ve,bk as Ze,T as he,bl as K,bm as et,f as o,b5 as Se,b6 as tt,bn as at,bo as nt,bp as rt,bq as lt,br as Ce,bs as st,bt as ot,b4 as it,bu as ut,bv as dt,F as ge,bw as ct,bx as vt,h as re,J as mt,G as Ie,by as ie,a as ee,M as te,c as D,bz as ft,am as pe,e as P,t as z,bA as ht,k as g,bB as gt,bC as pt,x as bt,j as J,i as le,bD as _t,bE as ue,bF as be,bG as yt,q as Re,s as Fe,I as kt,bH as St,ar as Be,bI as Ct,bJ as wt,A as Tt,B as Mt,aX as Nt,aY as Vt,b as we,K as It,a_ as Rt,aV as Ft,l as Bt,av as $t,D as Dt}from"./admin-c9ccc9d1.js";const Pt={name:"PaginationToolbar"};function Lt(e,t,r,u,l,i){return _(),$(Ye,{class:"paginationToolbar codexToolbar",density:"compact",transform:"center bottom"},Me({_:2},[oe(e.$slots,(h,a)=>({name:a,fn:B(s=>[Ne(e.$slots,a,Q({props:h},s),void 0,!0)])}))]),1024)}const on=j(Pt,[["render",Lt],["__scopeId","data-v-cfa8cce0"]]);const _e=Symbol.for("vuetify:v-slider");function zt(e,t,r){const u=r==="vertical",l=t.getBoundingClientRect(),i="touches"in e?e.touches[0]:e;return u?i.clientY-(l.top+l.height/2):i.clientX-(l.left+l.width/2)}function At(e,t){return"touches"in e&&e.touches.length?e.touches[0][t]:"changedTouches"in e&&e.changedTouches.length?e.changedTouches[0][t]:e[t]}const Et=Ge({disabled:Boolean,error:Boolean,readonly:Boolean,max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:e=>["vertical","horizontal"].includes(e)},reverse:Boolean,...He(),...We({elevation:2})},"slider"),Ot=e=>{let{props:t,handleSliderMouseUp:r,handleMouseMove:u,getActiveThumb:l}=e;const{isRtl:i}=Ke(),h=E(t,"reverse"),a=k(()=>{let d=i.value?"rtl":"ltr";return t.reverse&&(d=d==="rtl"?"ltr":"rtl"),d}),s=k(()=>parseFloat(t.min)),n=k(()=>parseFloat(t.max)),v=k(()=>t.step>0?parseFloat(t.step):0),f=k(()=>{const d=v.value.toString().trim();return d.includes(".")?d.length-d.indexOf(".")-1:0}),p=k(()=>parseInt(t.thumbSize,10)),y=k(()=>parseInt(t.tickSize,10)),c=k(()=>parseInt(t.trackSize,10)),m=k(()=>(n.value-s.value)/v.value),b=E(t,"disabled"),w=k(()=>t.direction==="vertical"),V=k(()=>t.error||t.disabled?void 0:t.thumbColor??t.color),S=k(()=>t.error||t.disabled?void 0:t.trackColor??t.color),q=k(()=>t.error||t.disabled?void 0:t.trackFillColor??t.color),L=Z(!1),M=Z(0),F=Z(),N=Z();function U(d){if(v.value<=0)return d;const T=ke(d,s.value,n.value),W=s.value%v.value,ce=Math.round((T-W)/v.value)*v.value+W;return parseFloat(Math.min(ce,n.value).toFixed(f.value))}function O(d){var T;const W=t.direction==="vertical",ce=W?"top":"left",Oe=W?"height":"width",xe=W?"clientY":"clientX",{[ce]:je,[Oe]:qe}=(T=F.value)==null?void 0:T.$el.getBoundingClientRect(),Ue=At(d,xe);let ve=Math.min(Math.max((Ue-je-M.value)/qe,0),1)||0;return(W||a.value==="rtl")&&(ve=1-ve),U(s.value+ve*(n.value-s.value))}let A=!1;const I=d=>{A||(M.value=0,r(O(d))),L.value=!1,A=!1,M.value=0},X=d=>{N.value=l(d),N.value&&(N.value.focus(),L.value=!0,N.value.contains(d.target)?(A=!0,M.value=zt(d,N.value,t.direction)):(M.value=0,u(O(d))))},x={passive:!0,capture:!0};function Y(d){A=!0,u(O(d))}function C(d){d.stopPropagation(),d.preventDefault(),I(d),window.removeEventListener("mousemove",Y,x),window.removeEventListener("mouseup",C)}function R(d){var T;I(d),window.removeEventListener("touchmove",Y,x),(T=d.target)==null||T.removeEventListener("touchend",R)}function G(d){var T;X(d),window.addEventListener("touchmove",Y,x),(T=d.target)==null||T.addEventListener("touchend",R,{passive:!1})}function ae(d){d.preventDefault(),X(d),window.addEventListener("mousemove",Y,x),window.addEventListener("mouseup",C,{passive:!1})}const H=d=>{const T=(d-s.value)/(n.value-s.value)*100;return ke(isNaN(T)?0:T,0,100)},ne=k(()=>t.ticks?Array.isArray(t.ticks)?t.ticks.map(d=>({value:d,position:H(d),label:d.toString()})):Object.keys(t.ticks).map(d=>({value:parseFloat(d),position:H(parseFloat(d)),label:t.ticks[d]})):m.value!==1/0?Je(m.value+1).map(d=>{const T=s.value+d*v.value;return{value:T,position:H(T)}}):[]),de=k(()=>ne.value.some(d=>{let{label:T}=d;return!!T})),ye={activeThumbRef:N,color:E(t,"color"),decimals:f,disabled:b,direction:E(t,"direction"),elevation:E(t,"elevation"),hasLabels:de,horizontalDirection:a,isReversed:h,min:s,max:n,mousePressed:L,numTicks:m,onSliderMousedown:ae,onSliderTouchstart:G,parsedTicks:ne,parseMouseMove:O,position:H,readonly:E(t,"readonly"),rounded:E(t,"rounded"),roundValue:U,showTicks:E(t,"showTicks"),startOffset:M,step:v,thumbSize:p,thumbColor:V,thumbLabel:E(t,"thumbLabel"),ticks:E(t,"ticks"),tickSize:y,trackColor:S,trackContainerRef:F,trackFillColor:q,trackSize:c,vertical:w};return Xe(_e,ye),ye},xt=fe({name:"VSliderThumb",directives:{Ripple:Qe},props:{focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0}},emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:r,emit:u}=t;const l=Ve(_e);if(!l)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:i,step:h,vertical:a,disabled:s,thumbSize:n,thumbLabel:v,direction:f,readonly:p,elevation:y,isReversed:c,horizontalDirection:m,mousePressed:b,decimals:w}=l,{textColorClasses:V,textColorStyles:S}=Ze(i),{pageup:q,pagedown:L,end:M,home:F,left:N,right:U,down:O,up:A}=rt,I=[q,L,M,F,N,U,O,A],X=k(()=>h.value?[1,2,3]:[1,5,10]);function x(C,R){if(!I.includes(C.key))return;C.preventDefault();const G=h.value||.1,ae=(e.max-e.min)/G;if([N,U,O,A].includes(C.key)){const ne=(m.value==="rtl"?[N,A]:[U,A]).includes(C.key)?1:-1,de=C.shiftKey?2:C.ctrlKey?1:0;R=R+ne*G*X.value[de]}else if(C.key===F)R=e.min;else if(C.key===M)R=e.max;else{const H=C.key===L?1:-1;R=R-H*G*(ae>100?ae/10:10)}return Math.max(e.min,Math.min(e.max,R))}function Y(C){const R=x(C,e.modelValue);R!=null&&u("update:modelValue",R)}return he(()=>{var C;const R=K(a.value||c.value?100-e.position:e.position,"%"),{elevationClasses:G}=et(k(()=>s.value?void 0:y.value));return o("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":e.focused,"v-slider-thumb--pressed":e.focused&&b.value}],style:{"--v-slider-thumb-position":R,"--v-slider-thumb-size":K(n.value)},role:"slider",tabindex:s.value?-1:0,"aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.modelValue,"aria-readonly":p.value,"aria-orientation":f.value,onKeydown:p.value?void 0:Y},[o("div",{class:["v-slider-thumb__surface",V.value,G.value],style:{...S.value}},null),Se(o("div",{class:["v-slider-thumb__ripple",V.value],style:S.value},null),[[tt("ripple"),!0,null,{circle:!0,center:!0}]]),o(at,{origin:"bottom center"},{default:()=>[Se(o("div",{class:"v-slider-thumb__label-container"},[o("div",{class:["v-slider-thumb__label"]},[o("div",null,[((C=r["thumb-label"])==null?void 0:C.call(r,{modelValue:e.modelValue}))??e.modelValue.toFixed(h.value?w.value:1)])])]),[[nt,v.value&&e.focused||v.value==="always"]])]})])}),{}}});const jt=fe({name:"VSliderTrack",props:{start:{type:Number,required:!0},stop:{type:Number,required:!0}},emits:{},setup(e,t){let{slots:r}=t;const u=Ve(_e);if(!u)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:l,horizontalDirection:i,parsedTicks:h,rounded:a,showTicks:s,tickSize:n,trackColor:v,trackFillColor:f,trackSize:p,vertical:y,min:c,max:m}=u,{roundedClasses:b}=lt(a),{backgroundColorClasses:w,backgroundColorStyles:V}=Ce(f),{backgroundColorClasses:S,backgroundColorStyles:q}=Ce(v),L=k(()=>`inset-${y.value?"block-end":"inline-start"}`),M=k(()=>y.value?"height":"width"),F=k(()=>({[L.value]:"0%",[M.value]:"100%"})),N=k(()=>e.stop-e.start),U=k(()=>({[L.value]:K(e.start,"%"),[M.value]:K(N.value,"%")})),O=k(()=>(y.value?h.value.slice().reverse():h.value).map((I,X)=>{var x;const Y=y.value?"bottom":"margin-inline-start",C=I.value!==c.value&&I.value!==m.value?K(I.position,"%"):void 0;return o("div",{key:I.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":I.position>=e.start&&I.position<=e.stop,"v-slider-track__tick--first":I.value===c.value,"v-slider-track__tick--last":I.value===m.value}],style:{[Y]:C}},[(I.label||r["tick-label"])&&o("div",{class:"v-slider-track__tick-label"},[((x=r["tick-label"])==null?void 0:x.call(r,{tick:I,index:X}))??I.label])])}));return he(()=>o("div",{class:["v-slider-track",b.value],style:{"--v-slider-track-size":K(p.value),"--v-slider-tick-size":K(n.value),direction:y.value?void 0:i.value}},[o("div",{class:["v-slider-track__background",S.value,{"v-slider-track__background--opacity":!!l.value||!f.value}],style:{...F.value,...q.value}},null),o("div",{class:["v-slider-track__fill",w.value],style:{...U.value,...V.value}},null),s.value&&o("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":s.value==="always"}]},[O.value])])),{}}}),qt=fe({name:"VSlider",props:{...st(),...Et(),...ot(),modelValue:{type:[Number,String],default:0}},emits:{"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,t){let{slots:r}=t;const u=Z(),{min:l,max:i,mousePressed:h,roundValue:a,onSliderMousedown:s,onSliderTouchstart:n,trackContainerRef:v,position:f,hasLabels:p,readonly:y}=Ot({props:e,handleSliderMouseUp:S=>c.value=a(S),handleMouseMove:S=>c.value=a(S),getActiveThumb:()=>{var S;return(S=u.value)==null?void 0:S.$el}}),c=it(e,"modelValue",void 0,S=>{const q=typeof S=="string"?parseFloat(S):S??l.value;return a(q)}),{isFocused:m,focus:b,blur:w}=ut(e),V=k(()=>f(c.value));return he(()=>{const[S,q]=dt(e),L=!!(e.label||r.label||r.prepend);return o(vt,Q({class:["v-slider",{"v-slider--has-labels":!!r["tick-label"]||p.value,"v-slider--focused":m.value,"v-slider--pressed":h.value,"v-slider--disabled":e.disabled}]},S,{focused:m.value}),{...r,prepend:L?M=>{var F,N;return o(ge,null,[((F=r.label)==null?void 0:F.call(r,M))??e.label?o(ct,{class:"v-slider__label",text:e.label},null):void 0,(N=r.prepend)==null?void 0:N.call(r,M)])}:void 0,default:M=>{let{id:F}=M;return o("div",{class:"v-slider__container",onMousedown:y.value?void 0:s,onTouchstartPassive:y.value?void 0:n},[o("input",{id:F.value,name:e.name||F.value,disabled:e.disabled,readonly:e.readonly,tabindex:"-1",value:c.value},null),o(jt,{ref:v,start:0,stop:V.value},{"tick-label":r["tick-label"]}),o(xt,{ref:u,focused:m.value,min:l.value,max:i.value,modelValue:c.value,"onUpdate:modelValue":N=>c.value=N,position:V.value,elevation:e.elevation,onFocus:b,onBlur:w},{"thumb-label":r["thumb-label"]})])}})}),{}}}),Ut={name:"PaginationSlider"};function Yt(e,t,r,u,l,i){return _(),$(qt,Q({"thumb-size":"36",class:"paginationSlider",density:"compact","hide-details":"auto",rounded:!0,"show-ticks":"always",step:1,"thumb-label":"always"},e.$attrs),null,16)}const un=j(Ut,[["render",Yt],["__scopeId","data-v-825b160e"]]);const Gt={name:"PaginationNavButton"};function Ht(e,t,r,u,l,i){return _(),$(re,Q({class:"paginationNavButton",height:"100%"},e.$attrs),Me({_:2},[oe(e.$slots,(h,a)=>({name:a,fn:B(s=>[Ne(e.$slots,a,Q({props:h},s),void 0,!0)])}))]),1040)}const dn=j(Gt,[["render",Ht],["__scopeId","data-v-852fad11"]]),Wt=function(e){let t;return e?t=e.length===4&&!Number.isNaN(e)?" ("+e+")":" v"+e:t="",t},$e=function({issue:e,issueSuffix:t},r){let u;try{e==null&&!t&&(e=0);const l=Number.parseFloat(e),i=Math.floor(l);r===void 0&&(r=0),l===i?u=i.toString():(u=l.toString(),r+=u.split(".")[1].length+1),u=u.padStart(r,"0")}catch{u=""}return t&&(u+=t),u},Kt=function({issue:e,issueSuffix:t,issueCount:r},u){let l="#"+$e({issue:e,issueSuffix:t},u);return r&&(l+=` of ${r}`),l},Jt=function({seriesName:e,volumeName:t,issue:r,issueSuffix:u,issueCount:l},i){const h=Wt(t),a=Kt({issue:r,issueSuffix:u,issueCount:l},i);return[e,h,a].filter(Boolean).join(" ")},De=mt.browser.vuetifyNullCode,Pe="None",Xt={value:De,title:Pe},Qt=function(e,t){let r;return e===void 0?r=e:e instanceof Object?(r={value:e.pk,title:e.name},e.pk===null||e.name===void 0?r.value=De:t||(r.value=+e.pk),(r.title===null||r.value===void 0)&&(r.title=Pe)):e===null?r=Xt:r={value:e,title:e.toString()},r},Zt=function(e,t){return e.title<t.title?-1:e.title>t.title?1:0},ea=function(e,t){return Number.parseFloat(e.name)-Number.parseFloat(t.name)},ta=function(e,t,r=!1,u=!1){const l=e||[],i=t&&t.toLowerCase();let h=[];for(const s of l){const n=Qt(s,u);n&&(!i||n.name.toLowerCase().includes(i))&&h.push(n)}const a=r?ea:Zt;return h.sort(a)},aa={name:"PlaceholderLoading",props:{size:{type:Number,default:128}}};function na(e,t,r,u,l,i){return _(),$(Ie,{indeterminate:"",size:r.size,color:e.$vuetify.theme.current.colors.primary,"aria-label":"loading"},null,8,["size","color"])}const cn=j(aa,[["render",na]]),ra=(e,t)=>e?`${ie(e)}/cover.webp?${t}`:window.CODEX.MISSING_COVER;const la={name:"BookCover",props:{group:{type:String,required:!0},childCount:{type:Number,default:1},finished:{type:Boolean},coverPk:{type:Number,required:!0}},data(){return{showPlaceholder:!1}},computed:{...ee(te,{coverSrc:function(e){return ra(this.coverPk,e.page.coversTimestamp)}})},mounted:function(){this.delayPlaceholder()},methods:{delayPlaceholder:function(){setTimeout(()=>{this.showPlaceholder=!0},2e3)}}},sa={class:"bookCover"},oa={key:1,class:"childCount"};function ia(e,t,r,u,l,i){return _(),D("div",sa,[o(ft,{src:e.coverSrc,class:"coverImg"},null,8,["src"]),r.finished!==!0?(_(),D("div",{key:0,class:pe({unreadFlag:!0,mixedreadFlag:r.finished===null})},null,2)):P("",!0),r.group!=="c"?(_(),D("span",oa,z(r.childCount),1)):P("",!0)])}const Le=j(la,[["render",ia],["__scopeId","data-v-9acb5f6a"]]);const ua={name:"MetadataTags",props:{label:{type:String,required:!0},items:{type:Array,default(){return[]}},values:{type:Array,default(){return[]}}},data(){return{mdiFilter:ht}},computed:{...ee(te,{filterValues:function(e){return e.settings.filters[this.label.toLowerCase()]}}),model(){return ta(this.values)}},methods:{chipColor:function(e){return this.filterValues&&this.filterValues.includes(e)?this.$vuetify.theme.current.colors["primary-darken-1"]:""}}},da={key:0,class:"tags"},ca={class:"label"};function va(e,t,r,u,l,i){return i.model&&i.model.length>0?(_(),D("div",da,[o(pt,{value:i.model,multiple:"",class:"chipGroup"},{default:B(()=>[g("div",ca,z(r.label),1),(_(!0),D(ge,null,oe(i.model,h=>(_(),$(gt,{key:`${r.label}/${h.value}`,color:i.chipColor(h.value),value:h.value,text:h.title},null,8,["color","value","text"]))),128))]),_:1},8,["value"])])):P("",!0)}const ze=j(ua,[["render",va],["__scopeId","data-v-80903885"]]);const ma={name:"MetadataTextBox",props:{label:{type:String,required:!0},value:{type:[Object,String,Number,Boolean],default:void 0},link:{type:Boolean,default:!1},highlight:{type:Boolean,default:!1}},data(){return{mdiOpenInNew:bt}},computed:{computedValue:function(){return this.value!=null&&this.value instanceof Object?this.value.name:this.value}}},fa={class:"textLabel"},ha=["href"],ga={key:1,class:"textContent"};function pa(e,t,r,u,l,i){return i.computedValue?(_(),D("div",{key:0,class:pe(["text",{highlight:r.highlight}])},[g("div",fa,z(r.label),1),r.link?(_(),D("a",{key:0,href:i.computedValue,target:"_blank"},[J(z(i.computedValue)+" ",1),o(le,{size:"small"},{default:B(()=>[J(z(l.mdiOpenInNew),1)]),_:1})],8,ha)):(_(),D("div",ga,z(i.computedValue),1))],2)):P("",!0)}const Ae=j(ma,[["render",pa],["__scopeId","data-v-48a2f357"]]);var se={},ba={get exports(){return se},set exports(e){se=e}};(function(e,t){(function(){var r=this,u=r.humanize,l={};e.exports&&(t=e.exports=l),t.humanize=l,l.noConflict=function(){return r.humanize=u,this},l.pad=function(a,s,n,v){if(a+="",n?n.length>1&&(n=n.charAt(0)):n=" ",v=v===void 0?"left":"right",v==="right")for(;a.length<s;)a=a+n;else for(;a.length<s;)a=n+a;return a},l.time=function(){return new Date().getTime()/1e3};var i=[0,0,31,59,90,120,151,181,212,243,273,304,334],h=[0,0,31,60,91,121,152,182,213,244,274,305,335];l.date=function(a,s){var n=s===void 0?new Date:s instanceof Date?new Date(s):new Date(s*1e3),v=/\\?([a-z])/gi,f=function(m,b){return c[m]?c[m]():b},p=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],y=["January","February","March","April","May","June","July","August","September","October","November","December"],c={d:function(){return l.pad(c.j(),2,"0")},D:function(){return c.l().slice(0,3)},j:function(){return n.getDate()},l:function(){return p[c.w()]},N:function(){return c.w()||7},S:function(){var m=c.j();return m>4&&m<21?"th":{1:"st",2:"nd",3:"rd"}[m%10]||"th"},w:function(){return n.getDay()},z:function(){return(c.L()?h[c.n()]:i[c.n()])+c.j()-1},W:function(){var m=c.z()-c.N()+1.5;return l.pad(1+Math.floor(Math.abs(m)/7)+(m%7>3.5?1:0),2,"0")},F:function(){return y[n.getMonth()]},m:function(){return l.pad(c.n(),2,"0")},M:function(){return c.F().slice(0,3)},n:function(){return n.getMonth()+1},t:function(){return new Date(c.Y(),c.n(),0).getDate()},L:function(){return new Date(c.Y(),1,29).getMonth()===1?1:0},o:function(){var m=c.n(),b=c.W();return c.Y()+(m===12&&b<9?-1:m===1&&b>9)},Y:function(){return n.getFullYear()},y:function(){return String(c.Y()).slice(-2)},a:function(){return n.getHours()>11?"pm":"am"},A:function(){return c.a().toUpperCase()},B:function(){var m=n.getTime()/1e3,b=m%86400+3600;b<0&&(b+=86400);var w=b/86.4%1e3;return m<0?Math.ceil(w):Math.floor(w)},g:function(){return c.G()%12||12},G:function(){return n.getHours()},h:function(){return l.pad(c.g(),2,"0")},H:function(){return l.pad(c.G(),2,"0")},i:function(){return l.pad(n.getMinutes(),2,"0")},s:function(){return l.pad(n.getSeconds(),2,"0")},u:function(){return l.pad(n.getMilliseconds()*1e3,6,"0")},O:function(){var m=n.getTimezoneOffset(),b=Math.abs(m);return(m>0?"-":"+")+l.pad(Math.floor(b/60)*100+b%60,4,"0")},P:function(){var m=c.O();return m.substr(0,3)+":"+m.substr(3,2)},Z:function(){return-n.getTimezoneOffset()*60},c:function(){return"Y-m-d\\TH:i:sP".replace(v,f)},r:function(){return"D, d M Y H:i:s O".replace(v,f)},U:function(){return n.getTime()/1e3||0}};return a.replace(v,f)},l.numberFormat=function(a,s,n,v){s=isNaN(s)?2:Math.abs(s),n=n===void 0?".":n,v=v===void 0?",":v;var f=a<0?"-":"";a=Math.abs(+a||0);var p=parseInt(a.toFixed(s),10)+"",y=p.length>3?p.length%3:0;return f+(y?p.substr(0,y)+v:"")+p.substr(y).replace(/(\d{3})(?=\d)/g,"$1"+v)+(s?n+Math.abs(a-p).toFixed(s).slice(2):"")},l.naturalDay=function(a,s){a=a===void 0?l.time():a,s=s===void 0?"Y-m-d":s;var n=86400,v=new Date,f=new Date(v.getFullYear(),v.getMonth(),v.getDate()).getTime()/1e3;return a<f&&a>=f-n?"yesterday":a>=f&&a<f+n?"today":a>=f+n&&a<f+2*n?"tomorrow":l.date(s,a)},l.relativeTime=function(a){a=a===void 0?l.time():a;var s=l.time(),n=s-a;if(n<2&&n>-2)return(n>=0?"just ":"")+"now";if(n<60&&n>-60)return n>=0?Math.floor(n)+" seconds ago":"in "+Math.floor(-n)+" seconds";if(n<120&&n>-120)return n>=0?"about a minute ago":"in about a minute";if(n<3600&&n>-3600)return n>=0?Math.floor(n/60)+" minutes ago":"in "+Math.floor(-n/60)+" minutes";if(n<7200&&n>-7200)return n>=0?"about an hour ago":"in about an hour";if(n<86400&&n>-86400)return n>=0?Math.floor(n/3600)+" hours ago":"in "+Math.floor(-n/3600)+" hours";var v=2*86400;if(n<v&&n>-v)return n>=0?"1 day ago":"in 1 day";var f=29*86400;if(n<f&&n>-f)return n>=0?Math.floor(n/86400)+" days ago":"in "+Math.floor(-n/86400)+" days";var p=60*86400;if(n<p&&n>-p)return n>=0?"about a month ago":"in about a month";var y=parseInt(l.date("Y",s),10),c=parseInt(l.date("Y",a),10),m=y*12+parseInt(l.date("n",s),10),b=c*12+parseInt(l.date("n",a),10),w=m-b;if(w<12&&w>-12)return w>=0?w+" months ago":"in "+-w+" months";var V=y-c;return V<2&&V>-2?V>=0?"a year ago":"in a year":V>=0?V+" years ago":"in "+-V+" years"},l.ordinal=function(a){a=parseInt(a,10),a=isNaN(a)?0:a;var s=a<0?"-":"";a=Math.abs(a);var n=a%100;return s+a+(n>4&&n<21?"th":{1:"st",2:"nd",3:"rd"}[a%10]||"th")},l.filesize=function(a,s,n,v,f,p){return s=s===void 0?1024:s,a<=0?"0 bytes":(a<s&&n===void 0&&(n=0),p===void 0&&(p=" "),l.intword(a,["bytes","KB","MB","GB","TB","PB"],s,n,v,f,p))},l.intword=function(a,s,n,v,f,p,y){var c,m;s=s||["","K","M","B","T"],m=s.length-1,n=n||1e3,v=isNaN(v)?2:Math.abs(v),f=f||".",p=p||",",y=y||"";for(var b=0;b<s.length;b++)if(a<Math.pow(n,b+1)){m=b;break}c=a/Math.pow(n,m);var w=s[m]?y+s[m]:"";return l.numberFormat(c,v,f,p)+w},l.linebreaks=function(a){return a=a.replace(/^([\n|\r]*)/,""),a=a.replace(/([\n|\r]*)$/,""),a=a.replace(/(\r\n|\n|\r)/g,`
`),a=a.replace(/(\n{2,})/g,"</p><p>"),a=a.replace(/\n/g,"<br />"),"<p>"+a+"</p>"},l.nl2br=function(a){return a.replace(/(\r\n|\n|\r)/g,"<br />")},l.truncatechars=function(a,s){return a.length<=s?a:a.substr(0,s)+"…"},l.truncatewords=function(a,s){var n=a.split(" ");return n.length<s?a:n.slice(0,s).join(" ")+"…"}}).call(_t)})(ba,se);const me=se,_a=e=>{const t=ue();return be.get(`c/${e}`,{params:t})},ya=()=>{const e=ue();return be.get("c/settings",{params:e})},ka=e=>be.put("c/settings",e),Sa=e=>{const t=ie(e),r=ue().ts;return`${t}/download.cbz?ts=${r}`},vn=({pk:e,page:t})=>{const r=ie(e),u=ue().ts;return`${r}/${t}/page.jpg?ts=${u}`},mn={getReaderBasePath:ie,getReaderInfo:_a,getReaderSettings:ya,setReaderSettings:ka};const Ca={name:"MetadataCreditsTable",props:{value:{type:Array,default:void 0}},data(){return{}},computed:{sortedCredits:function(){return this.value?[...this.value].sort(this.creditsCompare):[]},...ee(te,{filteredCreators(e){return e.settings.filters.creators}})},methods:{roleName:function(e){return e==="CoverArtist"?"Cover Artist":e},creditSortable:function(e){const t=e.person.name.split(" ");let r=[];return t&&(r.push(t.slice(-1)),t.length>1&&r.push(t.slice(0,-1))),r.push(e.role.name),r.join(" ")},creditsCompare:function(e,t){const r=this.creditSortable(e),u=this.creditSortable(t);return r<u?-1:r>u?1:0},isFilteredCreator(e){return this.filteredCreators&&this.filteredCreators.includes(e)}}},Ee=e=>(Re("data-v-0552ad41"),e=e(),Fe(),e),wa=Ee(()=>g("h2",null,"Credits",-1)),Ta={class:"highlight-table"},Ma=Ee(()=>g("thead",null,[g("tr",null,[g("th",{class:"text-left"},"Role"),g("th",{class:"text-left"},"Creator")])],-1)),Na={class:"highlight"};function Va(e,t,r,u,l,i){return i.sortedCredits&&i.sortedCredits.length>0?(_(),$(yt,{key:0,id:"creditsTable"},{default:B(()=>[wa,g("table",Ta,[Ma,g("tbody",null,[(_(!0),D(ge,null,oe(i.sortedCredits,h=>(_(),D("tr",{key:h.pk},[g("td",null,z(i.roleName(h.role.name)),1),g("td",{class:pe({filteredOn:i.isFilteredCreator(h.person.pk)})},[g("span",Na,z(h.person.name),1)],2)]))),128))])])]),_:1})):P("",!0)}const Ia=j(Ca,[["render",Va],["__scopeId","data-v-0552ad41"]]),Ra=({pk:e,page:t,readLtr:r,pageCount:u})=>{if(u){if(t)t=Number(t);else if(r)t=0;else{const l=Number(u)-1;t=Math.max(l,0)}return{name:"reader",params:{pk:e,page:t}}}},Te=kt("metadata",{state:()=>({md:void 0}),actions:{async loadMetadata({group:e,pk:t}){const r=te();await St.getMetadata({group:e,pk:t},r.settings).then(u=>(this.md=u.data,!0)).catch(u=>{console.error(u),this.clearMetadata()})},clearMetadata(){this.md=void 0}}});const Fa=1160,Ba=.05,$a=250,Da={comic:"Comic Archive",pdf:"PDF"},Pa={name:"MetadataButton",components:{BookCover:Le,CloseButton:Be,MetadataCreditsTable:Ia,MetadataTags:ze,MetadataText:Ae},props:{group:{type:String,required:!0},pk:{type:Number,required:!0},children:{type:Number,default:1}},data(){return{mdiDownload:Ct,mdiTagOutline:wt,dialog:!1,progress:0}},computed:{...Tt(Mt,["isUserAdmin"]),...ee(Te,{md:e=>e.md,downloadFileName:e=>{const t=e.md;return e.md.path?t.path.split("/").at(-1):Jt({seriesName:t.series.name,volumeName:t.volume.name,issue:t.issue,issueSuffix:t.issueSuffix})+".cbz"}}),...ee(te,{q:e=>e.settings.q}),downloadURL:function(){return Sa(this.pk)},isReadButtonShown:function(){return this.group==="c"&&this.$route.name!="reader"},isReadButtonEnabled:function(){return this.$route.name==="browser"&&Boolean(this.readerRoute)},readButtonIcon:function(){return this.isReadButtonEnabled?Nt:Vt},readerRoute:function(){return Ra(this.md)},formattedIssue:function(){if(!((this.md.issue===null||this.md.issue===void 0)&&!this.md.issueSuffix))return $e({issue:this.md.issue,issueSuffix:this.md.issueSuffix})},ltrText:function(){return this.md.readLtr?"Left to Right":"Right to Left"},pages:function(){let e="";if(this.md.page){const r=me.numberFormat(this.md.page,0);e+=`Read ${r} of `}const t=me.numberFormat(this.md.pageCount,0);return e+=`${t} pages`,this.md.progress>0&&(e+=` (${Math.round(this.md.progress)}%)`),e},size:function(){return me.filesize(this.md.size)},fileFormat:function(){return Da[this.md.fileFormat]||this.md.fileFormat}},watch:{dialog:function(e){e?this.dialogOpened():this.clearMetadata()}},mounted(){window.addEventListener("keyup",this._keyListener)},unmounted(){window.removeEventListener("keyup",this._keyListener)},methods:{...we(Te,["clearMetadata","loadMetadata"]),...we(It,["downloadIOSPWAFix"]),dialogOpened:function(){this.loadMetadata({group:this.group,pk:this.pk}),this.startProgress()},startProgress:function(){this.startTime=Date.now(),this.estimatedMS=Math.max(Ba,this.children/Fa)*1e3,this.updateProgress()},updateProgress:function(){const e=Date.now()-this.startTime;this.progress=e/this.estimatedMS*100,!(this.progress>=100||this.md)&&setTimeout(()=>{this.updateProgress()},$a)},formatDateTime:function(e){const t=new Date(e);return Rt.format(t).replace(",","")},download(){this.downloadIOSPWAFix(this.downloadURL,this.downloadFileName)},_keyListener(e){e.stopImmediatePropagation(),e.key==="Escape"&&(this.dialog=!1)}}},La=e=>(Re("data-v-753b4d9c"),e=e(),Fe(),e),za={key:0,id:"metadataContainer"},Aa={id:"metadataHeader"},Ea={id:"metadataBookCoverWrapper"},Oa={class:"headerHalfRow"},xa={class:"headerQuarterRow"},ja={class:"mdSection"},qa={key:0,class:"inlineRow"},Ua={id:"metadataBody"},Ya={class:"mdSection"},Ga={class:"thirdRow"},Ha={class:"mdSection"},Wa={class:"quarterRow"},Ka={class:"lastSmallRow"},Ja={class:"halfRow mdSection"},Xa={class:"mdSection"},Qa={class:"mdSection"},Za={class:"mdSection"},en={class:"mdSection"},tn={id:"footerLinks"},an={id:"bottomRightButtons"},nn={key:1,id:"placeholderContainer"},rn=La(()=>g("div",{id:"placeholderTitle"},"Tags Loading",-1));function ln(e,t,r,u,l,i){const h=Be,a=Ae,s=Le,n=ze,v=Dt("MetadataCreditsTable");return _(),$($t,{modelValue:l.dialog,"onUpdate:modelValue":t[4]||(t[4]=f=>l.dialog=f),fullscreen:"",transition:"dialog-bottom-transition"},{activator:B(({props:f})=>[o(re,Q({"aria-label":"tags",class:"tagButton cardControlButton",icon:"",title:"Tags",variant:"text"},f,{onClick:t[0]||(t[0]=Ft(()=>{},["prevent"]))}),{default:B(()=>[o(le,null,{default:B(()=>[J(z(l.mdiTagOutline),1)]),_:1})]),_:2},1040)]),default:B(()=>[e.md?(_(),D("div",za,[g("header",Aa,[o(h,{class:"closeButton",title:"Close Metadata (esc)",size:"x-large",onClick:t[1]||(t[1]=f=>l.dialog=!1)}),e.q?(_(),$(a,{key:0,id:"search",value:e.q,label:"Search Query",highlight:!0},null,8,["value"])):P("",!0),g("div",Ea,[o(s,{id:"bookCover","cover-pk":e.md.coverPk,group:r.group,"child-count":e.md.childCount,finished:e.md.finished},null,8,["cover-pk","group","child-count","finished"]),o(Bt,{class:"bookCoverProgress","model-value":e.md.progress,rounded:"","background-color":"inherit",height:"2","aria-label":"% read"},null,8,["model-value"])]),g("div",Oa,[o(a,{id:"publisher",value:e.md.publisher,label:"Publisher",highlight:e.md.group==="p"},null,8,["value","highlight"]),o(a,{id:"imprint",value:e.md.imprint,label:"Imprint",highlight:e.md.group==="i"},null,8,["value","highlight"])]),o(a,{id:"series",value:e.md.series,label:"Series",highlight:e.md.group==="s"},null,8,["value","highlight"]),g("div",xa,[o(a,{id:"volume",value:e.md.volume,label:"Volume",highlight:e.md.group==="v"},null,8,["value","highlight"]),o(a,{value:e.md.volumeCount,label:"Volume Count"},null,8,["value"]),o(a,{id:"issue",value:i.formattedIssue,label:"Issue",highlight:e.md.group==="c"},null,8,["value","highlight"]),o(a,{value:e.md.issueCount,label:"Issue Count"},null,8,["value"])]),g("section",ja,[o(a,{value:e.md.name,label:"Title"},null,8,["value"]),e.md.year||e.md.month||e.md.day?(_(),D("div",qa,[o(a,{value:e.md.year,label:"Year",class:"datePicker",type:"number"},null,8,["value"]),o(a,{value:e.md.month,label:"Month",class:"datePicker"},null,8,["value"]),o(a,{value:e.md.day,label:"Day",class:"datePicker"},null,8,["value"])])):P("",!0),o(a,{value:e.md.format,label:"Format"},null,8,["value"])])]),g("div",Ua,[g("section",Ya,[g("div",Ga,[o(a,{value:i.pages,label:"Pages"},null,8,["value"]),o(a,{value:e.md.finished,label:"Finished"},null,8,["value"]),o(a,{value:i.ltrText,label:"Reading Direction"},null,8,["value"])])]),g("section",Ha,[g("div",Wa,[e.md.createdAt?(_(),$(a,{key:0,value:i.formatDateTime(e.md.createdAt),label:"Created at",class:"mtime"},null,8,["value"])):P("",!0),e.md.updatedAt?(_(),$(a,{key:1,value:i.formatDateTime(e.md.updatedAt),label:"Updated at",class:"mtime"},null,8,["value"])):P("",!0),o(a,{value:i.size,label:"Size"},null,8,["value"]),o(a,{value:i.fileFormat,label:"File Type"},null,8,["value"])]),g("div",Ka,[o(a,{value:e.md.path,label:"Path"},null,8,["value"])])]),g("section",Ja,[o(a,{value:e.md.country,label:"Country"},null,8,["value"]),o(a,{value:e.md.language,label:"Language"},null,8,["value"])]),g("section",Xa,[o(a,{value:e.md.communityRating,label:"Community Rating"},null,8,["value"]),o(a,{value:e.md.criticalRating,label:"Critical Rating"},null,8,["value"]),o(a,{value:e.md.ageRating,label:"Age Rating"},null,8,["value"])]),g("section",Qa,[o(n,{values:e.md.genres,label:"Genres"},null,8,["values"]),o(n,{values:e.md.tags,label:"Tags"},null,8,["values"]),o(n,{values:e.md.teams,label:"Teams"},null,8,["values"]),o(n,{values:e.md.characters,label:"Characters"},null,8,["values"]),o(n,{values:e.md.locations,label:"Locations"},null,8,["values"]),o(n,{values:e.md.storyArcs,label:"Story Arcs"},null,8,["values"]),o(n,{values:e.md.seriesGroups,label:"Series Groups"},null,8,["values"])]),g("section",Za,[o(a,{value:e.md.web,label:"Web Link",link:!0},null,8,["value"]),o(a,{value:e.md.summary,label:"Summary"},null,8,["value"]),o(a,{value:e.md.comments,label:"Comments"},null,8,["value"]),o(a,{value:e.md.notes,label:"Notes"},null,8,["value"]),o(a,{value:e.md.scanInfo,label:"Scan"},null,8,["value"])]),g("section",en,[o(v,{value:e.md.credits},null,8,["value"])])]),g("footer",tn,[r.group==="c"?(_(),$(re,{key:0,id:"downloadButton",title:"Download Comic Archive",onClick:i.download},{default:B(()=>[r.group==="c"?(_(),$(le,{key:0},{default:B(()=>[J(z(l.mdiDownload),1)]),_:1})):P("",!0),J(" Download ")]),_:1},8,["onClick"])):P("",!0),i.isReadButtonShown?(_(),$(re,{key:1,to:i.readerRoute,title:"Read Comic",disabled:!i.isReadButtonEnabled},{default:B(()=>[o(le,null,{default:B(()=>[J(z(i.readButtonIcon),1)]),_:1}),J(" Read ")]),_:1},8,["to","disabled"])):P("",!0),g("span",an,[o(h,{class:"closeButton",title:"Close Metadata (esc)",size:"x-large",onClick:t[2]||(t[2]=f=>l.dialog=!1)})])])])):(_(),D("div",nn,[o(h,{class:"closeButton",title:"Close Metadata (esc)",onClick:t[3]||(t[3]=f=>l.dialog=!1)}),rn,o(Ie,{"model-value":l.progress,indeterminate:l.progress>=100,size:"256",class:"placeholder","aria-label":"tags loading"},null,8,["model-value","indeterminate"])]))]),_:1},8,["modelValue"])}const fn=j(Pa,[["render",ln],["__scopeId","data-v-753b4d9c"]]);export{mn as A,cn as P,dn as _,un as a,on as b,fn as c,Kt as d,Le as e,Wt as f,Jt as g,me as h,Ra as i,vn as j,Sa as k,ta as t};
