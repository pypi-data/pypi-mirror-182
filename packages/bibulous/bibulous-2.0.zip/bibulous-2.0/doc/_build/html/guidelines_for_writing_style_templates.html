
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Guidelines for writing bibliography style templates &#8212; Bibulous 1.3.2 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Instructions on how to report a bug to the Bibulous development team" href="instructions_for_reporting_bugs.html" />
    <link rel="prev" title="Frequently asked questions" href="faq.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="index.html"><img src="_static/banner.svg" border="0" height=300 alt="py4sci"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="instructions_for_reporting_bugs.html" title="Instructions on how to report a bug to the Bibulous development team"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Frequently asked questions"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo_small.svg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Guidelines for writing bibliography style templates</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
<li><a class="reference internal" href="#default-fields">Default Fields</a><ul>
<li><a class="reference internal" href="#operators">Operators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#options-keywords">Options keywords</a></li>
<li><a class="reference internal" href="#implicit-loops-and-examples-for-namelist-formatting">Implicit loops and examples for namelist formatting</a></li>
<li><a class="reference internal" href="#python-api">Python API</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="faq.html"
                        title="previous chapter">Frequently asked questions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="instructions_for_reporting_bugs.html"
                        title="next chapter">Instructions on how to report a bug to the Bibulous development team</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/guidelines_for_writing_style_templates.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="guidelines-for-writing-bibliography-style-templates">
<h1>Guidelines for writing bibliography style templates<a class="headerlink" href="#guidelines-for-writing-bibliography-style-templates" title="Permalink to this headline">¶</a></h1>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Comments begin with <code class="docutils literal notranslate"><span class="pre">#</span></code>, following the Python convention.</p>
</li>
<li><p class="first">Each template file can have as many as five sections. None of the sections are required to be in the file, but any definitions in the file must be placed inside a section header so that the code knows how to deal with the definition. The four possible section headers are: TEMPLATES, SPECIAL-TEMPLATES, OPTIONS, VARIABLES, DEFINITIONS. And note that a section header is always placed by itself on a line and has a colon appended to it, as in <code class="docutils literal notranslate"><span class="pre">TEMPLATES:</span></code>.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">TEMPLATES</span></code> section of the file contains template definitions for formatting references. The <code class="docutils literal notranslate"><span class="pre">SPECIAL-TEMPLATES</span></code> section contains definitions for creating variables within each database entry. The <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code> section contains definitions for various keywords that can be used to modify program behavior. The <code class="docutils literal notranslate"><span class="pre">VARIABLES</span></code> section contains user definitions for new variables to be made available. The difference between these definitions and those in <code class="docutils literal notranslate"><span class="pre">SPECIAL-TEMPLATES</span></code> is that the ones provided in the <code class="docutils literal notranslate"><span class="pre">VARIABLES</span></code> section are in-line Python code, whereas the former use templates. Finally, the <code class="docutils literal notranslate"><span class="pre">DEFINITIONS</span></code> section of the file contains Python-executable code that can then make functionality available in the form of template variables. (An example is provided in the <em>Python API</em> section below.</p>
</li>
<li><p class="first">All variable definitions within the TEMPLATES, SPECIAL-TEMPLATES, and OPTIONS sections use the variable name followed by whitespace, an equals sign, more whitespace, and then the definition itself. Thus the [whitespace+=+whitespace] expression is the delimiter between variable and definition, and is required syntax.</p>
</li>
<li><p class="first">An ellipsis <code class="docutils literal notranslate"><span class="pre">...</span></code> at the end of a line indicates a line continuation. All whitespace following the ellipsis, and all whitespace preceding text on the next line, is removed from the resulting connected text.</p>
</li>
<li><p class="first">An ellipsis in the middle of a line indicates an “implicit loop”. For details, see the <em>Examples for namelist formatting</em> section below.</p>
</li>
<li><p class="first">Inside the <code class="docutils literal notranslate"><span class="pre">TEMPLATES</span></code> section, all of the variable definitions are intended to map to a database entrytype name. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>article = &lt;au&gt;, ``&lt;title&gt;,&#39;&#39; &lt;journal&gt;, &lt;volume&gt;, &lt;startpage&gt;--&lt;endpage&gt; (&lt;year&gt;).
</pre></div>
</div>
<p>Here the <code class="docutils literal notranslate"><span class="pre">article</span></code> entrytype will be typeset so that the list of authors (<code class="docutils literal notranslate"><span class="pre">&lt;au&gt;</span></code>) is followed by the article title in double quotes, the journal name in standard font (i.e. not italics), the volume number, the page range, and the year.</p>
</li>
<li><p class="first">A variable is indicated by angle brackets, as <code class="docutils literal notranslate"><span class="pre">&lt;var&gt;</span></code> and represents the contents of a field found within the bibliography database. Thus, when typesetting the bibliography, Bibulous will replace the variable <code class="docutils literal notranslate"><span class="pre">&lt;authorlist&gt;</span></code> with the string stored in the <code class="docutils literal notranslate"><span class="pre">authorlist</span></code> field of the current entry being formatted. An example list of typical variables one might use is:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">&lt;au&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;booktitle&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;chapter&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;edition&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;ed&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;eid&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;endpage&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;institution&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;journal&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;nationality&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;note&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;number&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;organization&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;publisher&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;school&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;series&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;startpage&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;title&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;version&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;volume&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;year&gt;</span></code>.</p>
</div></blockquote>
<p>This list is actually freely extensible. A user can add any additional variables needed, so that if a <code class="docutils literal notranslate"><span class="pre">video</span></code> field is used in a <code class="docutils literal notranslate"><span class="pre">.bib</span></code> database file, then this can be used within a formatted reference simply by placing <code class="docutils literal notranslate"><span class="pre">&lt;video&gt;</span></code> into the template wherever the information needs to be inserted.</p>
</li>
<li><p class="first">Any variable placed within square brackets <code class="docutils literal notranslate"><span class="pre">[]</span></code> indicate that it is an optional variable — it is not required that the database have that entry. While required entries that are not defined in the BibTeX database file (.bib file) are replaced with ‘???’, and undefined optional variables are simply skipped. If a <code class="docutils literal notranslate"><span class="pre">|</span></code> is present within the square brackets, it indicates an “elseif” clause. That is, if the template is <code class="docutils literal notranslate"><span class="pre">[&lt;var1&gt;|&lt;var2&gt;</span> <span class="pre">and</span> <span class="pre">&lt;var3&gt;]</span></code>, then the code will look for <code class="docutils literal notranslate"><span class="pre">var1</span></code> as a field within the current database entry being formatted. If it does not find the entry, then it will try the next block, where it finds the two variables <code class="docutils literal notranslate"><span class="pre">var2</span></code> and <code class="docutils literal notranslate"><span class="pre">var3</span></code>. If both are defined, then the original template <code class="docutils literal notranslate"><span class="pre">[&lt;var1&gt;|&lt;var2&gt;</span> <span class="pre">and</span> <span class="pre">&lt;var3&gt;]</span></code> is replaced with <code class="docutils literal notranslate"><span class="pre">&lt;var2&gt;</span> <span class="pre">and</span> <span class="pre">&lt;var3&gt;</span></code> (i.e. removing the square brackets) and proceeds to replace the two variables with their corresponding fields. If either one of <code class="docutils literal notranslate"><span class="pre">var2</span></code> or <code class="docutils literal notranslate"><span class="pre">var3</span></code> is undefined in the entry, then the entire optional (bracketed) portion of the template is skipped.</p>
</li>
<li><p class="first">If the <code class="docutils literal notranslate"><span class="pre">|</span></code> symbol is used to create an empty last cell, as in <code class="docutils literal notranslate"><span class="pre">[&lt;var1&gt;|&lt;var2&gt;|]</span></code>, this indicates that while the individual cells within the optional block are themselves optional, it is required to have at least _one_ among the cells to be defined. Thus, <code class="docutils literal notranslate"><span class="pre">[&lt;note&gt;|]</span></code> has the same meaning as simply <code class="docutils literal notranslate"><span class="pre">&lt;note&gt;</span></code> does.</p>
</li>
<li><p class="first">Nesting of <code class="docutils literal notranslate"><span class="pre">[]</span></code> brackets is allowed, but the syntax becomes computationally expensive to parse, so that these structures should be used sparingly.</p>
</li>
<li><p class="first">Users that need to use <code class="docutils literal notranslate"><span class="pre">[</span></code>, <code class="docutils literal notranslate"><span class="pre">]</span></code>, <code class="docutils literal notranslate"><span class="pre">#</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, or <code class="docutils literal notranslate"><span class="pre">|</span></code> symbols as formatting elements within the reference list can implement them using some custom LaTeX-markup commands: <code class="docutils literal notranslate"><span class="pre">{\makeopenbracket}</span></code>, <code class="docutils literal notranslate"><span class="pre">{\makeclosebracket}</span></code>, <code class="docutils literal notranslate"><span class="pre">{\makehashsign}</span></code>, <code class="docutils literal notranslate"><span class="pre">{\makelessthan}</span></code>, <code class="docutils literal notranslate"><span class="pre">{\makegreaterthan}</span></code>, <code class="docutils literal notranslate"><span class="pre">{\makeverticalbar}</span></code>, or <code class="docutils literal notranslate"><span class="pre">{\makeellipsis}</span></code>. Note that the curly brackets used in each case are required.</p>
</li>
<li><p class="first">In the <code class="docutils literal notranslate"><span class="pre">TEMPLATES</span></code> section of the file, if an entrytype format definition contains only another entrytype name on the right hand side of the <code class="docutils literal notranslate"><span class="pre">=</span></code>, i.e.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inbook</span> <span class="o">=</span> <span class="n">incollection</span>
</pre></div>
</div>
<p>then this means that the existing <code class="docutils literal notranslate"><span class="pre">incollection</span></code> template should be copied for use with <code class="docutils literal notranslate"><span class="pre">inbook</span></code> entrytypes.</p>
</li>
<li><p class="first">Note that several fields are defined by default which are <em>not</em> directly from the bibliography database. These are <code class="docutils literal notranslate"><span class="pre">au</span></code>, <code class="docutils literal notranslate"><span class="pre">authorlist</span></code>, <code class="docutils literal notranslate"><span class="pre">citekey</span></code>, <code class="docutils literal notranslate"><span class="pre">citenum</span></code>, <code class="docutils literal notranslate"><span class="pre">ed</span></code>, <code class="docutils literal notranslate"><span class="pre">editorlist</span></code>, <code class="docutils literal notranslate"><span class="pre">endpage</span></code>, and <code class="docutils literal notranslate"><span class="pre">startpage</span></code>. These fields are derived from the original database file, but have been reformatted. See the <em>Default Fields</em> section below.</p>
</li>
<li><p class="first">Although the entrytype template definitions listed below are in alphabetical order, that can be put in any desired order within the file. The exception to this rule is that if a definition consists of, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inbook</span> <span class="o">=</span> <span class="n">incollection</span>
</pre></div>
</div>
<p>then the <code class="docutils literal notranslate"><span class="pre">incollection</span></code> template must already be defined. Also note that two entrytype names are special and so cannot be used on the left hand side of the equals sign here: <code class="docutils literal notranslate"><span class="pre">comment</span></code> and <code class="docutils literal notranslate"><span class="pre">preamble</span></code>.</p>
</li>
<li><p class="first">A user wanting a localized form of quotation should use <code class="docutils literal notranslate"><span class="pre">\enquote{&lt;title&gt;}</span></code> rather than <code class="docutils literal notranslate"><span class="pre">``&lt;title&gt;''</span></code>, and add <code class="docutils literal notranslate"><span class="pre">\usepackage{csquotes}</span></code> to the preamble of the LaTeX document.</p>
</li>
<li><p class="first">In the <code class="docutils literal notranslate"><span class="pre">OPTIONS</span></code> section of the file are the formatting options. None of these definitions are required. The complete list is given in the <em>Options keywords</em> section below, together with explanations of each.</p>
</li>
<li><p class="first">The <code class="docutils literal notranslate"><span class="pre">SPECIAL-TEMPLATES</span></code> section is where users can define their own fields that get generated for every database entry evaluated. For example, the variable definition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">group</span> <span class="o">=</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">organization</span><span class="o">&gt;|&lt;</span><span class="n">institution</span><span class="o">&gt;|&lt;</span><span class="n">corporation</span><span class="o">&gt;|</span><span class="p">]</span>
</pre></div>
</div>
<p>in the <code class="docutils literal notranslate"><span class="pre">SPECIAL-TEMPLATES</span></code> section will create a <code class="docutils literal notranslate"><span class="pre">group</span></code> field that can be used as the variable <code class="docutils literal notranslate"><span class="pre">&lt;group&gt;</span></code> within the regular <code class="docutils literal notranslate"><span class="pre">TEMPLATES</span></code> section of the file. This effectively allows users to create a shortcut. Where they could write out <code class="docutils literal notranslate"><span class="pre">[&lt;organization&gt;|&lt;institution&gt;|&lt;corporation&gt;|]</span></code> inside each template that needs this structure, the special template definition allows them to replace each instance with a simple <code class="docutils literal notranslate"><span class="pre">&lt;group&gt;</span></code>.</p>
<p>Another example usage would be the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">author</span> <span class="o">=</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">author</span><span class="o">-</span><span class="n">en</span><span class="o">&gt;|&lt;</span><span class="n">author</span><span class="o">-</span><span class="n">jp</span><span class="o">&gt;|</span><span class="p">]</span>
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">author</span></code> field is actually redefined to include not only the <em>existing</em> author field, but also the fields <code class="docutils literal notranslate"><span class="pre">author-en</span></code> or <code class="docutils literal notranslate"><span class="pre">author-jp</span></code>. That is, if the <code class="docutils literal notranslate"><span class="pre">author</span></code> field is missing in the database entry (the field matching the thing on the left hand side), the code next searches for the <code class="docutils literal notranslate"><span class="pre">author-en</span></code> field. If it finds it, then it will create an <code class="docutils literal notranslate"><span class="pre">author</span></code> field that contains a copy of the <code class="docutils literal notranslate"><span class="pre">author-en</span></code>’s field’s contents. If the <code class="docutils literal notranslate"><span class="pre">author-en</span></code> is also missing, the code next searches for <code class="docutils literal notranslate"><span class="pre">author-jp</span></code> and uses that fields contents to create the missing <code class="docutils literal notranslate"><span class="pre">author</span></code> field. This is a convenient way of grouping different variable names in order to simplify templates.</p>
</li>
<li><p class="first">The order in which any definitions are placed within the special templates is important. For example, if a user has <code class="docutils literal notranslate"><span class="pre">au</span> <span class="pre">=</span> <span class="pre">&lt;authorlist.format_authorlist()&gt;</span></code> and then below that defines <code class="docutils literal notranslate"><span class="pre">authorlist</span> <span class="pre">=</span> <span class="pre">&lt;author.to_namelist()&gt;</span></code>, then the code will issue an error stating that <code class="docutils literal notranslate"><span class="pre">authorlist</span></code> is not defined when attempting to create the <code class="docutils literal notranslate"><span class="pre">au</span></code> variable. Since the definition for <code class="docutils literal notranslate"><span class="pre">au</span></code> assumes the presence of the <code class="docutils literal notranslate"><span class="pre">authorlist</span></code> variable, the latter definition must be placed above it.</p>
</li>
</ol>
</div>
<div class="section" id="default-fields">
<h2>Default Fields<a class="headerlink" href="#default-fields" title="Permalink to this headline">¶</a></h2>
<p>A complete list of the existing default fields is::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">au</span>
<span class="n">authorlist</span>
<span class="n">citealnum</span>
<span class="n">citealpha</span>
<span class="n">citekey</span>
<span class="n">citenum</span>
<span class="n">ed</span>
<span class="n">editorlist</span>
<span class="n">sortkey</span>
<span class="n">sortnum</span>
</pre></div>
</div>
<p>Each of these default fields are defined as “special templates”. If a user defines a special template with the same name as one of the above, then the default is overwritten with the user’s version. The definitions of the default special templates are::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>authorlist = &lt;author.to_namelist()&gt;
editorlist = &lt;editor.to_namelist()&gt;
citealnum = ?
citelabel = &lt;citenum&gt;
sortkey = &lt;citenum&gt;
au = &lt;authorlist.format_authorlist()&gt;
ed = &lt;editorlist.format_editorlist()&gt;
</pre></div>
</div>
<p>Note that the ordering of definitions is important (that is, if <code class="docutils literal notranslate"><span class="pre">citelabel</span></code> uses <code class="docutils literal notranslate"><span class="pre">authorlist</span></code> in its definition, then the latter has to appear before it in the list of special templates, so that it is defined by the time that <code class="docutils literal notranslate"><span class="pre">citelabel</span></code> needs to be defined). The following summarizes what these definitions are used for.</p>
<p>Also, in addition to these default fields, there are also four special variables defined, <code class="docutils literal notranslate"><span class="pre">citealpha</span></code>, <code class="docutils literal notranslate"><span class="pre">citealnum</span></code>, <code class="docutils literal notranslate"><span class="pre">citenum</span></code>, and <code class="docutils literal notranslate"><span class="pre">sortnum</span></code>. These can be accessed as <code class="docutils literal notranslate"><span class="pre">&lt;citealpha&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;citealnum&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;citenum&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&lt;sortnum&gt;</span></code> within any template. The first, <code class="docutils literal notranslate"><span class="pre">&lt;citealpha&gt;</span></code>, is designed to reproduce the citation label style used by BibTeX’s <code class="docutils literal notranslate"><span class="pre">alpha</span></code> style. For example, <code class="docutils literal notranslate"><span class="pre">GKP94</span></code> is the <code class="docutils literal notranslate"><span class="pre">alpha</span></code>–style citation label for the book <em>Concrete Mathematics</em>, 2nd Edition, by Ronald L. Graham, Donald E. Knuth, and Oren Patashnik (1994). The second variable <code class="docutils literal notranslate"><span class="pre">&lt;citealnum&gt;</span></code> is a variant of this that creates a citation label from the first letter of the author’s last name, followed by an integer indicating its place in the sorted bibliography. Thus the book by Graham <em>et al.</em> would have the label “G2” if preceded by, say, <em>Introduction to Fourier Optics</em> by Joseph W. Goodman (1968), since the latter, being published earlier, would be placed earlier in the sorted list. <code class="docutils literal notranslate"><span class="pre">&lt;citenum&gt;</span></code> is simply the numerical order in which the reference was cited in the text (starting at 1 with the first citation). <code class="docutils literal notranslate"><span class="pre">&lt;sortnum&gt;</span></code> is the numerical order in which the citation appears in the reference list. If the reference list is sorted alphabetically, for example, then <code class="docutils literal notranslate"><span class="pre">sortnum</span></code> will generally be different from <code class="docutils literal notranslate"><span class="pre">citenum</span></code>.</p>
<p><strong>au</strong> is the string representing the formatted list of author names. In the default definition shown above, the name list is a standard form, and so simply uses the <code class="docutils literal notranslate"><span class="pre">.format_authorlist()</span></code> operator. Generally, this operator creates name lists that have the form “firstauthor” for only one author, “firstauthor and secondauthor” if only two authors, “firstauthor, secondauthor, …, and lastauthor” if more than two authors but less than the maximum, and “firstauthor, secondauthor, …, minauthor, et al.” if more than the maximum allowed number of authors. Which author in the list is “minauthor” is defined using the <code class="docutils literal notranslate"><span class="pre">minauthors</span></code> option keyword. The maximum number of allowed authors is set by the <code class="docutils literal notranslate"><span class="pre">maxauthors</span></code> option keyword.</p>
<p><strong>authorlist</strong> creates a list of dictionaries (one dictionary for each author name found within the database entry’s <code class="docutils literal notranslate"><span class="pre">author</span></code> field). Each name dictionary has keys “first”, “middle”, “prefix”, “last”, and “suffix”, where each of these keys is optional except for “last”. Thus, a user can access the first and last name of the first author in the database entry using <code class="docutils literal notranslate"><span class="pre">&lt;authorlist.0.first&gt;</span> <span class="pre">&lt;authorlist.0.last&gt;</span></code>. To access the middle name(s) of the second author, use <code class="docutils literal notranslate"><span class="pre">&lt;authorlist.1.middle&gt;</span></code>.</p>
<p><strong>citealnum</strong> is a field generated by taking the first letter of the first author’s last name, and appending to it the citation sort order number within all entries sharing that prefix. Thus “Bugs Bunny” would have a <code class="docutils literal notranslate"><span class="pre">citealnum</span></code> of “B” followed by its order number. If “Yogi Bear” were another first-author name in the list, then “Yogi Bear” would receive <code class="docutils literal notranslate"><span class="pre">citealnum</span> <span class="pre">=</span> <span class="pre">B1</span></code> while “Bugs Bunny” would receive <code class="docutils literal notranslate"><span class="pre">citealnum</span> <span class="pre">=</span> <span class="pre">B2</span></code>.</p>
<p><strong>citealpha</strong> is a field generated according to BibTeX’s classic “alpha” style. That is, it takes the first three letters of the author’s last name if there is only one author. If multiple authors, it takes the initials of the author last names, for up to the first three authors. If no author is present, then it looks for the first three letters of the <code class="docutils literal notranslate"><span class="pre">organization</span></code> field. Finally, the three-letter alphabetical label is followed by the last two digits of the publication year. Thus, any user wishing to use BibTeX’s classic <code class="docutils literal notranslate"><span class="pre">alpha</span></code> style for citation labels can use <code class="docutils literal notranslate"><span class="pre">citelabel</span> <span class="pre">=</span> <span class="pre">&lt;citealpha&gt;</span></code> in the SPECIAL-TEMPLATES section of the file.</p>
<p><strong>citelabel</strong> is the thing that appears at the front of the formatted reference, and is identical to the citation label used in the manuscript to point to the item in the reference list. In technical journal articles, this is typically just a number, as in the default definition <code class="docutils literal notranslate"><span class="pre">&lt;citenum&gt;</span></code>. The number used here for the label indicates the order in which the entry was cited.</p>
<p><strong>ed</strong> follows the same basic structure as <code class="docutils literal notranslate"><span class="pre">au</span></code>, but uses the <code class="docutils literal notranslate"><span class="pre">maxeditors</span></code> and <code class="docutils literal notranslate"><span class="pre">mineditors</span></code> keywords.</p>
<p><strong>editorlist</strong> behaves exactly as <code class="docutils literal notranslate"><span class="pre">authorlist</span></code> but derives its list of names from the database entry’s <code class="docutils literal notranslate"><span class="pre">editor</span></code> field rather than <code class="docutils literal notranslate"><span class="pre">author</span></code> field.</p>
<p><strong>sortkey</strong> is the string used to sort the entry within the reference list. For technical journal articles, what is generally wanted is just the citation order, as indicated by the <code class="docutils literal notranslate"><span class="pre">&lt;citenum&gt;</span></code> variable.</p>
<div class="section" id="operators">
<h3>Operators<a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h3>
<p>One can use the “dot” operator inside a variable name, as in <code class="docutils literal notranslate"><span class="pre">&lt;authorname.0.last.initial()&gt;''</span> <span class="pre">to</span> <span class="pre">perform</span> <span class="pre">any</span> <span class="pre">one</span> <span class="pre">of</span> <span class="pre">five</span> <span class="pre">functions:</span> <span class="pre">a</span> <span class="pre">explicit</span> <span class="pre">numerical</span> <span class="pre">index</span> <span class="pre">(the</span> <span class="pre">``0</span></code> shown here, listed as the <code class="docutils literal notranslate"><span class="pre">.#</span></code> operator below), an implicit numerical index (using <code class="docutils literal notranslate"><span class="pre">.n</span></code> or <code class="docutils literal notranslate"><span class="pre">.N</span></code>, for which see section <em>Examples for namelist formatting</em> below for details), a range index (listed as the <code class="docutils literal notranslate"><span class="pre">##:##</span></code> operator below), a dictionary lookup (the <code class="docutils literal notranslate"><span class="pre">last</span></code> used here), or the application of an operator (in this case, the <code class="docutils literal notranslate"><span class="pre">.initial()</span></code> operator which is used to reduce a name to its initial). A numerical index must apply to a list-type of variable, and a key index must apply to a dict-type of variable (i.e. a dictionary). Note that, due to limitations of the parser, it is not allowed for <code class="docutils literal notranslate"><span class="pre">&lt;.&gt;</span></code> angle-bracketed variables to be placed within other angle-bracketed variables. Thus, function arguments take variable names with their angle brackets removed.</p>
<p>The complete list of operators available is::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="c1">#</span>
<span class="o">.</span><span class="c1">##:##</span>
<span class="o">.</span><span class="n">compress</span><span class="p">()</span>
<span class="o">.</span><span class="n">format_authorlist</span><span class="p">()</span>
<span class="o">.</span><span class="n">format_editorlist</span><span class="p">()</span>
<span class="o">.</span><span class="n">frenchinitial</span><span class="p">()</span>
<span class="o">.</span><span class="n">if_len_equals</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="n">number</span><span class="p">,</span><span class="n">var2</span><span class="p">,</span><span class="n">var3</span><span class="p">)</span>
<span class="o">..</span>    <span class="o">.</span><span class="n">if_len_less_than</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="n">number</span><span class="p">,</span><span class="n">var2</span><span class="p">,</span><span class="n">var3</span><span class="p">)</span>
<span class="o">..</span>    <span class="o">.</span><span class="n">if_len_more_than</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="n">number</span><span class="p">,</span><span class="n">var2</span><span class="p">,</span><span class="n">var3</span><span class="p">)</span>
<span class="o">.</span><span class="n">if_str_equal</span><span class="p">(</span><span class="n">test_str</span><span class="p">,</span><span class="n">then_var</span><span class="p">,</span><span class="n">else_var</span><span class="p">)</span>
<span class="o">.</span><span class="n">if_singular</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span><span class="n">var2</span><span class="p">,</span><span class="n">var3</span><span class="p">)</span>
<span class="o">.</span><span class="n">initial</span><span class="p">()</span>
    <span class="o">.</span><span class="n">len</span><span class="p">()</span>
<span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="o">.</span><span class="n">monthabbrev</span><span class="p">()</span>
<span class="o">.</span><span class="n">monthname</span><span class="p">()</span>
<span class="o">.</span><span class="n">n</span>
<span class="o">.</span><span class="n">N</span>
<span class="o">.</span><span class="n">null</span><span class="p">()</span>
<span class="o">.</span><span class="n">ordinal</span><span class="p">()</span>
<span class="o">.</span><span class="n">purify</span><span class="p">()</span>
<span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old</span><span class="p">,</span><span class="n">new</span><span class="p">)</span>
<span class="o">.</span><span class="n">sentence_case</span><span class="p">()</span>
<span class="o">.</span><span class="n">tie</span><span class="p">()</span>
<span class="o">.</span><span class="n">to_namelist</span><span class="p">()</span>
<span class="o">.</span><span class="n">uniquify</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
<span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
</pre></div>
</div>
<p>The function of each operator is summarized below.</p>
<p><strong>.#</strong> An explicit numerical index, i.e., select the #th element of the operand.</p>
<p><strong>.##:##</strong> A range index, i.e., select the ##th through ##th elements of the operand. For example, for a bibliography entry whose database file contains <code class="docutils literal notranslate"><span class="pre">title</span> <span class="pre">=</span> <span class="pre">{Impossibility}</span></code>, a template variable of the form <code class="docutils literal notranslate"><span class="pre">&lt;title.0:2&gt;</span></code> will return <code class="docutils literal notranslate"><span class="pre">Imp</span></code>, and <code class="docutils literal notranslate"><span class="pre">&lt;title.3:5&gt;</span></code> will return <code class="docutils literal notranslate"><span class="pre">oss</span></code>. The first character of the operand thus has an index <code class="docutils literal notranslate"><span class="pre">0</span></code>. Indexing from the end of the operand can be done using negative number indices. For example, the last character of the operand can be indexed by <code class="docutils literal notranslate"><span class="pre">-1</span></code>, and the third to last by <code class="docutils literal notranslate"><span class="pre">-3</span></code>, so that in the example above, <code class="docutils literal notranslate"><span class="pre">&lt;title.-3:-1&gt;</span></code> will return <code class="docutils literal notranslate"><span class="pre">ity</span></code>.</p>
<p><strong>.compress()</strong> removes any whitespace found within the string. This is useful for generating namelists where the format requires “tight” spacing. An example would be “RMA Azzam”, where the three initials are grouped together without spacing. And example template for generating this type of name would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">first</span><span class="o">&gt;&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">middle</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">.</span><span class="n">compress</span><span class="p">()</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">last</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Without the <code class="docutils literal notranslate"><span class="pre">.compress()</span></code> operator, the name would come out as “RM A Azzam”, since the two middle name initials “M” and “A” are spaced apart from one another by default.</p>
<p><strong>.format_authorlist()</strong> operates on a list of dictionaries type of variable (a namelist), and uses the keyword-based default formatting scheme to create a formatted string of names. The complete list keywords that it looks for is: <code class="docutils literal notranslate"><span class="pre">etal_message</span></code>, <code class="docutils literal notranslate"><span class="pre">maxauthors</span></code>, <code class="docutils literal notranslate"><span class="pre">minauthors</span></code>, <code class="docutils literal notranslate"><span class="pre">namelist_format</span></code>, <code class="docutils literal notranslate"><span class="pre">period_after_initial</span></code>, <code class="docutils literal notranslate"><span class="pre">terse_inits</span></code>, <code class="docutils literal notranslate"><span class="pre">use_firstname_initials</span></code>, <code class="docutils literal notranslate"><span class="pre">use_name_ties</span></code>. The default formatter, while fast, is not very flexible, so that users looking for more customizability will want to make use of Bibulous’ implicit-index and implicit-loop based definitions. See the <em>Example definitions for namelist formatting</em> section below.</p>
<p><strong>.format_editorlist()</strong> operates on a list of dictionaries type of variable (a namelist), and uses the keyword-based default formatting scheme to create a formatted string of names.  The complete list keywords that looks for is: <code class="docutils literal notranslate"><span class="pre">etal_message</span></code>, <code class="docutils literal notranslate"><span class="pre">maxeditors</span></code>, <code class="docutils literal notranslate"><span class="pre">mineditors</span></code>, <code class="docutils literal notranslate"><span class="pre">namelist_format</span></code>, <code class="docutils literal notranslate"><span class="pre">period_after_initial</span></code>, <code class="docutils literal notranslate"><span class="pre">terse_inits</span></code>, <code class="docutils literal notranslate"><span class="pre">use_firstname_initials</span></code>, <code class="docutils literal notranslate"><span class="pre">use_name_ties</span></code>. (The difference with the <code class="docutils literal notranslate"><span class="pre">.format_authorlist()</span></code> operator is that it uses <code class="docutils literal notranslate"><span class="pre">maxeditors</span></code> and <code class="docutils literal notranslate"><span class="pre">mineditors</span></code> rather than <code class="docutils literal notranslate"><span class="pre">maxauthors</span></code> and <code class="docutils literal notranslate"><span class="pre">minauthors</span></code>) The default formatter, while fast, is not very flexible, so that users looking for more customizability will want to make use of Bibulous’ implicit-index and implicit-loop based definitions. See the <em>Example definitions for namelist formatting</em> section below.</p>
<p><strong>.frenchinitial()</strong> is an alternative form of the <code class="docutils literal notranslate"><span class="pre">.initial()</span></code> operator that has slightly different behavior. If a name begins with one of the digraphs “Ch”, “Gn”, “Ll”, “Ph”, “Ss”, or “Th”, then the initial will truncate the name after the digraph instead of after the first letter.</p>
<p><strong>.if_str_equal(test_str,then_var,else_var)</strong> inserts <code class="docutils literal notranslate"><span class="pre">then_var</span></code> if the string to be operated on is equal to <code class="docutils literal notranslate"><span class="pre">test_str</span></code>, else it inserts the string <code class="docutils literal notranslate"><span class="pre">else_var</span></code>.</p>
<p><strong>.if_singular(var,res1,res2)</strong> inserts <code class="docutils literal notranslate"><span class="pre">res1</span></code> if <code class="docutils literal notranslate"><span class="pre">var</span></code> has only one element, but <code class="docutils literal notranslate"><span class="pre">res2</span></code> if <code class="docutils literal notranslate"><span class="pre">var</span></code> has more than one element. Here <code class="docutils literal notranslate"><span class="pre">var</span></code> is assumed to be a list-type of variable. An example usage is the following: <code class="docutils literal notranslate"><span class="pre">[&lt;ed.if_singular(editorlist,</span> <span class="pre">option.edmsg1),</span> <span class="pre">option.edmsg2)&gt;,</span> <span class="pre">]</span></code>. This form appends the contents of the <code class="docutils literal notranslate"><span class="pre">edmsg1</span></code> option variable to the end of the <code class="docutils literal notranslate"><span class="pre">ed</span></code> variable if the <code class="docutils literal notranslate"><span class="pre">editorlist</span></code> variable contains only one element (is singular). If <code class="docutils literal notranslate"><span class="pre">editorlist</span></code> has more than one element, then the contents of the <code class="docutils literal notranslate"><span class="pre">edmsg2</span></code> variable is appended instead. (This could potentially be a null string.)</p>
<p><strong>.if_num_equals(var,number,res1,res2)</strong> appends <code class="docutils literal notranslate"><span class="pre">res1</span></code> if <code class="docutils literal notranslate"><span class="pre">var</span></code> equals <code class="docutils literal notranslate"><span class="pre">number</span></code>, but otherwise appends <code class="docutils literal notranslate"><span class="pre">var2</span></code>.</p>
<p><strong>.initial()</strong> will truncate the string to its first letter. Note that if a name begins with a LaTeX markup character, such as <code class="docutils literal notranslate"><span class="pre">{\'E}</span></code>, then the operator will convert the input string to its best attempt at a Unicode-equivalent (without character markup) prior to performing the truncation. Thus, applying the <code class="docutils literal notranslate"><span class="pre">.initial()</span></code> operator to the name <code class="docutils literal notranslate"><span class="pre">{\v{Z}}ukauskas</span></code> will produce the initialized form “Ž”.</p>
<p><strong>.len()</strong> returns the number of elements in a list variable (to the left of the operator dot).</p>
<p><strong>.lower()</strong> reduces all letters in its argument to lower case. If any LaTeX markup letters exist in the argument, then they will be converted to Unicode equivalents first before applying the operator. Thus, if the field <code class="docutils literal notranslate"><span class="pre">au</span></code> contains <code class="docutils literal notranslate"><span class="pre">{\AA}</span></code> then the operator will first convert this to the letter Å and then reduce it to the lower case å.</p>
<p><strong>.monthabbrev()</strong> assumes that the input field is a number from 1 to 12, and converts the numerical input into the abbreviated month according to the user’s current locale. If the system cannot determine the user’s locale, the operator will default to using the American English locale, which replaces the numerical field operated on with one of “Jan”, “Feb”, “Mar”, “Apr”, “May”, “Jun”, “Jul”, “Aug”, “Sep”, “Oct”, “Nov”, or “Dec” according to the field’s value. Thus, if the bibliography database entry has a field <code class="docutils literal notranslate"><span class="pre">month</span> <span class="pre">=</span> <span class="pre">11</span></code>, and the template has the form <code class="docutils literal notranslate"><span class="pre">&lt;month.monthabbrev()&gt;</span></code>, then the template will be replaced with “Nov” for the default locale. For users with locale “Japan”, this same operator will return “11月”.</p>
<p><strong>.monthname()</strong> behaves much like <code class="docutils literal notranslate"><span class="pre">.monthabbrev()</span></code> but rather than using an abbreviated form for the month’s name, it uses the full form. Thus if the bibliography database entry has a field <code class="docutils literal notranslate"><span class="pre">month</span> <span class="pre">=</span> <span class="pre">3</span></code>, and the template has the form <code class="docutils literal notranslate"><span class="pre">&lt;month.monthname()&gt;</span></code>, then the template variable will be replaced with “March” for the default locale. For users with locale “Norway”, this same operator will return “Mars”.</p>
<p><strong>.n</strong> See the <em>Examples for namelist formatting</em> below</p>
<p><strong>.N</strong> [Not currently supported]</p>
<p><strong>.null()</strong> returns an undefined variable, forcing the string to be evaluated as “undefined”.</p>
<p><strong>.ordinal()</strong> creates an “ordinal” from a numerical field. Thus, if the field operated on is “1”, “2”, “3”, or “4”, then the operator will replace the template with “1st”, “2nd”, “3rd” or “4th”. Any number above 4 simply has “th” appended to the end of it. Currently Bibulous does not support non-English locales for this function. (Anyone having suggestions of how this may be implemented without too much fuss should contact us!)</p>
<p><strong>.purify()</strong> attempts to convert its argument into a string without LaTeX-markup for foreign characters. Thus, if the entry contains <code class="docutils literal notranslate"><span class="pre">title</span> <span class="pre">=</span> <span class="pre">{{\AA}land}</span></code> then a template variable of the form <code class="docutils literal notranslate"><span class="pre">&lt;title.purify()&gt;</span></code> will produce the result <code class="docutils literal notranslate"><span class="pre">Åland</span></code>. This can be useful when having to use <code class="docutils literal notranslate"><span class="pre">substr_replace()</span></code> and other functions where the markup may cause matching problems.</p>
<p><strong>.replace(old,new)</strong> will replace the substring <code class="docutils literal notranslate"><span class="pre">old</span></code> with <code class="docutils literal notranslate"><span class="pre">new</span></code> wherever it finds <code class="docutils literal notranslate"><span class="pre">old</span></code> within the string it is applied to. For example, if a user wants to make the name “J. W. Tukey” bold everywhere it appears in a reference, then <code class="docutils literal notranslate"><span class="pre">.replace(J.</span> <span class="pre">W.</span> <span class="pre">Tukey,\textbf{J.</span> <span class="pre">W.</span> <span class="pre">Tukey})</span></code> will work. Note that whitespace is preserved here. Thus, <code class="docutils literal notranslate"><span class="pre">.replace(J.</span> <span class="pre">W.</span> <span class="pre">Tukey,</span> <span class="pre">\textbf{J.</span> <span class="pre">W.</span> <span class="pre">Tukey})</span></code> will add a space in front of <code class="docutils literal notranslate"><span class="pre">\textbf{J.</span> <span class="pre">W.</span> <span class="pre">Tukey}</span></code>. Also, Bibulous will not allow the use of <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">|</span></code>, or <code class="docutils literal notranslate"><span class="pre">)</span></code> characters in the two arguments of the operator.</p>
<p><strong>.sentence_case()</strong> reduces the lower case any characters in the field, except for the initial letter and any letters protected within a pair of curly braces. For example, if the database entry has <code class="docutils literal notranslate"><span class="pre">title</span> <span class="pre">=</span> <span class="pre">{Understanding</span> <span class="pre">Bohmian</span> <span class="pre">mechanics}</span></code> and the template has the form <code class="docutils literal notranslate"><span class="pre">&lt;title.sentence_case()&gt;</span></code>, then the template variable will be replaced with “Understanding bohmian mechanics”. However, if the entry has <code class="docutils literal notranslate"><span class="pre">title</span> <span class="pre">=</span> <span class="pre">{Understanding</span> <span class="pre">{B}ohmian</span> <span class="pre">mechanics}</span></code>, the result will be “Understanding {B}ohmian mechanics”.</p>
<p><strong>.tie()</strong> replaces any spaces with an unbreakable space. Thus, “R. M. A.” becomes “R.~M.~A.”. An example use of this operator would be the following template::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">authorname</span> <span class="o">=</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.~</span><span class="p">][</span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">middle</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">.</span><span class="n">tie</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">]</span><span class="o">...</span>
             <span class="p">[</span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">prefix</span><span class="o">&gt;~</span><span class="p">]</span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">last</span><span class="o">&gt;</span><span class="p">[,</span> <span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">suffix</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p><strong>.to_namelist()</strong> parses the field (assumed to be a BibTeX-format “and”-delimited list of names) into a Bibulous-format namelist (i.e. a list of dictionaries).</p>
<p><strong>.uniquify(arg)</strong> appends a letter character (if arg=``a``) or a number (if arg=``1``) to the end of the field to make it unique relative to the same field in every other cited entry. For example, if two authors have the name “Smith” and published a paper in the year 2000, then the template <code class="docutils literal notranslate"><span class="pre">citelabel</span> <span class="pre">=</span> <span class="pre">&lt;authorlist.0.last&gt;&lt;year&gt;</span></code> will produce the same citation label for both entries. Thus, we can rename this as <code class="docutils literal notranslate"><span class="pre">citetemp</span> <span class="pre">=</span> <span class="pre">&lt;authorlist.0.last&gt;&lt;year&gt;</span></code> and then define <code class="docutils literal notranslate"><span class="pre">citelabel</span> <span class="pre">=</span> <span class="pre">&lt;citetemp.uniquify(a)&gt;</span></code> to generate unique labels. For this example, the first citation will have the label “Smith2000” and the second “Smith2000a”. If a third citation shares the same name and year, then it will be given the unique label “Smith2000b”, and so on.</p>
<p><strong>.upper()</strong> raises all letters in its argument to upper case. If any LaTeX markup letters exist in the argument, then they will be converted to Unicode equivalents first before applying the operator. Thus, if the field <code class="docutils literal notranslate"><span class="pre">au</span></code> contains <code class="docutils literal notranslate"><span class="pre">{\aa}</span></code> then the operator will first convert this to the letter å and then raise it to the upper case Å.</p>
<p><strong>.zfill(num)</strong> appends zeros to the front of its argument, where <code class="docutils literal notranslate"><span class="pre">num</span></code> indicates the desired final length of the string. For example, if the field <code class="docutils literal notranslate"><span class="pre">vol</span></code> contains the number <code class="docutils literal notranslate"><span class="pre">11</span></code>, then calling <code class="docutils literal notranslate"><span class="pre">&lt;vol.zfill(3)&gt;</span></code> produces the result <code class="docutils literal notranslate"><span class="pre">011</span></code>.</p>
</div>
</div>
<div class="section" id="options-keywords">
<h2>Options keywords<a class="headerlink" href="#options-keywords" title="Permalink to this headline">¶</a></h2>
<p>A complete list of existing options keywords, together with their default definitions, is::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>allow_scripts = False
autocomplete_doi = True
backrefs = False
backrefstyle = none
bibitemsep = None
case_sensitive_field_names = False
edmsg1 = , ed.
edmsg2 = , eds
etal_message = , \\textit{et al.}
maxauthors = 9
maxeditors = 5
minauthors = 9
mineditors = 5
name_separator = and
namelist_format = first_name_first
period_after_initial = True
procspie_as_journal = False
sort_case = True
sort_order = forward
terse_inits = False
undefstr = ???
use_abbrevs = True
use_citeextract = True
use_firstname_initials = True
use_name_ties = False
</pre></div>
</div>
<p>Each of the keywords is summarized below.</p>
<p><strong>allow_scripts</strong> [default value: False] tells Bibulous whether to allow the evaluation of Python code in the VARIABLES and DEFINITIONS sections of <code class="docutils literal notranslate"><span class="pre">.bst</span></code> files. It is important for users to realize that evaluating external code in this way is a security risk, and so they should not set <code class="docutils literal notranslate"><span class="pre">allow_scripts</span> <span class="pre">=</span> <span class="pre">True</span></code> when inserting code that they do not trust. However, as an additional security precaution, Bibulous prevents most security-sensitive operations from being used within its Python API.</p>
<p><strong>autocomplete_doi</strong> [default value: True] tells Bibulous whether to add <code class="docutils literal notranslate"><span class="pre">http://dx.doi.org/</span></code> to the front of the <code class="docutils literal notranslate"><span class="pre">doi</span></code> field if the front is missing. This allows the <code class="docutils literal notranslate"><span class="pre">&lt;doi&gt;</span></code> variable to be used as a complete URL, even when the prefix is missing in the database field.</p>
<p><strong>backrefs</strong> [default value: False] THIS KEYWORD IS NOT YET IMPLEMENTED</p>
<p><strong>backrefstyle</strong> [default value: none] THIS KEYWORD IS NOT YET IMPLEMENTED</p>
<p><strong>bibitemsep</strong> [default value: None] provides users a means to change the amount of vertical separation that LaTeX sets between entries in the reference list. For example, users wanting a more compact list can define <code class="docutils literal notranslate"><span class="pre">bibitemsep</span> <span class="pre">=</span> <span class="pre">0pt</span></code>.</p>
<p><strong>case_sensitive_field_names</strong> [default value: False] tells Bibulous whether to consider, for example, a field named “Author” as being distinct from “author”.</p>
<p><strong>edmsg1</strong> [default value: , ed.] provides a string to use after a list of editor names, for the case when only one editor is present.</p>
<p><strong>edmsg2</strong> [default value: , eds] provides a string to use after a list of editor names, for the case when multiple editors are present.</p>
<p><strong>etal_message</strong> [default value: , \textit{et al.}] provides a string to use after a truncated namelist (for example, when the number of authors exceeds the value given by the <code class="docutils literal notranslate"><span class="pre">maxauthors</span></code> keyword).</p>
<p><strong>maxauthors</strong> [default value: 9] provides the maximum number of allowed names in the formatted list of authors. If the number of names is more than this, then the list of names is truncated to <code class="docutils literal notranslate"><span class="pre">minauthors</span></code> and the <code class="docutils literal notranslate"><span class="pre">etal_message</span></code> is appended to the result. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
<p><strong>maxeditors</strong> [default value: 5] provides the maximum number of allowed names in the formatted list of editors. If the number of names is more than this, then the list of names is truncated to <code class="docutils literal notranslate"><span class="pre">mineditors</span></code> and the <code class="docutils literal notranslate"><span class="pre">etal_message</span></code> is appended to the result. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
<p><strong>minauthors</strong> [default value: 9] provides the minimum number of author names to use when truncating an overlength author name list. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
<p><strong>mineditors</strong> [default value: 5] provides the minimum number of editor names to use when truncating an overlength author name list. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
<p><strong>name_separator</strong> [default value: and] informs Bibulous how to separate the individual names in a BibTeX-format field of names. For example, with a BibTeX-format field of <code class="docutils literal notranslate"><span class="pre">Bugs</span> <span class="pre">Bunny</span> <span class="pre">and</span> <span class="pre">Porky</span> <span class="pre">Pig</span></code>, using the separator <code class="docutils literal notranslate"><span class="pre">and</span></code> allows Bibulous to determine that there are two separate people, <code class="docutils literal notranslate"><span class="pre">Bugs</span> <span class="pre">Bunny</span></code> and <code class="docutils literal notranslate"><span class="pre">Porky</span> <span class="pre">Pig</span></code>. If the option keyword has an empty field (<em>i.e.</em> it is written as <code class="docutils literal notranslate"><span class="pre">name_separator</span> <span class="pre">=</span></code>, with nothing on the right hand side of the equals) then it is assumed that the intended separator is a space character. This is useful for alphabets (such as Chinese and Japanese) that often work without spaces.</p>
<p><strong>namelist_format</strong> [default value: first_name_first, allowed values: {first_name_first, last_name_first}] defines how the formatted list of names should appear. If <code class="docutils literal notranslate"><span class="pre">namelist_format</span> <span class="pre">=</span> <span class="pre">first_name_first</span></code> then the individual names will appear in the order “firstname middle prefix last, suffix”. If <code class="docutils literal notranslate"><span class="pre">namelist_format</span> <span class="pre">=</span> <span class="pre">last_name_first</span></code> then the individual names will appear in the order “prefix last, firstname middle, suffix”. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
<p><strong>period_after_initial</strong> [default value: True] tells the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator whether to place a period after each initial of an individual’s name. Thus, if <code class="docutils literal notranslate"><span class="pre">period_after_initial</span> <span class="pre">=</span> <span class="pre">True</span></code>, a name will appear as “R. M. A. Azzam”, but if <code class="docutils literal notranslate"><span class="pre">False</span></code> will appear as “R M A Azzam”. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
<p><strong>procspie_as_journal</strong> [default value: False] The “Proceedings of SPIE” are treated as special by the journals of the Optical Society of America. That is, they format these proceedings (and only these) in the same way that they do journal articles. Thus, a special keyword is required to allow this behavior.</p>
<p><strong>sort_case</strong> [default value: True] informs Bibulous whether or not to use case-sensitive sorting of reference keys.</p>
<p><strong>sort_order</strong> [default value: forward] whether to sort in increasing order (<code class="docutils literal notranslate"><span class="pre">forward</span></code>) or decreasing order (<code class="docutils literal notranslate"><span class="pre">reverse</span></code>).</p>
<p><strong>terse_inits</strong> [default value: False] tells the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator whether to compress together the initials of an individual’s name. Thus, if <code class="docutils literal notranslate"><span class="pre">terse_inits</span> <span class="pre">=</span> <span class="pre">True</span></code>, a name will appear as “RMA Azzam”, but if <code class="docutils literal notranslate"><span class="pre">False</span></code> will appear as “R. M. A. Azzam”. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
<p><strong>undefstr</strong> [default value: ???] informs Bibulous what kind of warning message to print when a required field is missing in the database entry.</p>
<p><strong>use_abbrevs</strong> [default value: True] tells Bibulous whether or not to use the abbreviations defined in the bibliography database. (Used for debugging.)</p>
<p><strong>use_citeextract</strong> [default value: True] tells Bibulous whether to perform “citation extraction”, which creates a small database of only the cited items from among the complete database provided in the <code class="docutils literal notranslate"><span class="pre">.aux</span></code> file.</p>
<p><strong>use_firstname_initials</strong> [default value: True] Whether or not to initialize the first names of authors in the formatted authors list. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
<p><strong>use_name_ties</strong> [default value: False] Whether or not to replace spaces with unbreakable spaces (i.e. “R. M. A. Azzam” or “R.~M.~A. Azzam”) inside names in the name list. (This keyword is only used within the <code class="docutils literal notranslate"><span class="pre">.format_namelist()</span></code> operator.)</p>
</div>
<div class="section" id="implicit-loops-and-examples-for-namelist-formatting">
<h2>Implicit loops and examples for namelist formatting<a class="headerlink" href="#implicit-loops-and-examples-for-namelist-formatting" title="Permalink to this headline">¶</a></h2>
<p>The following code provides an example usage of implicit indexing within an implicit loop structure::</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">authorlist</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">author</span><span class="o">.</span><span class="n">to_namelist</span><span class="p">()</span><span class="o">&gt;</span>
<span class="n">editorlist</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">editor</span><span class="o">.</span><span class="n">to_namelist</span><span class="p">()</span><span class="o">&gt;</span>
<span class="n">authorname</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">][</span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">middle</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">]</span><span class="o">...</span>
               <span class="p">[</span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">prefix</span><span class="o">&gt;</span> <span class="p">]</span><span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">last</span><span class="o">&gt;</span><span class="p">[,</span> <span class="o">&lt;</span><span class="n">authorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">suffix</span><span class="o">&gt;</span><span class="p">]</span>
<span class="n">au</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">authorname</span><span class="o">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">,{</span> <span class="ow">and</span> <span class="p">}</span><span class="o">&lt;</span><span class="n">authorname</span><span class="o">.</span><span class="mi">9</span><span class="o">&gt;</span>
<span class="n">editorname</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">][</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">middle</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">]</span><span class="o">...</span>
               <span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">prefix</span><span class="o">&gt;</span> <span class="p">]</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">last</span><span class="o">&gt;</span><span class="p">[,</span> <span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">suffix</span><span class="o">&gt;</span><span class="p">]</span>
<span class="n">ed</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">,{</span> <span class="ow">and</span> <span class="p">}</span><span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Here the <code class="docutils literal notranslate"><span class="pre">authorlist</span></code> and <code class="docutils literal notranslate"><span class="pre">editorlist</span></code> definitions create namelist variables from the <code class="docutils literal notranslate"><span class="pre">author</span></code> and <code class="docutils literal notranslate"><span class="pre">editor</span></code> fields in the entry (if they exist). Next, the implicitly-indexed <code class="docutils literal notranslate"><span class="pre">authorname.n</span></code> cannot operate except within an implicit loop, and so we should describe that first. It is easier to describe the functionality of the <code class="docutils literal notranslate"><span class="pre">ed</span></code> template than the <code class="docutils literal notranslate"><span class="pre">au</span></code> one, as it has a smaller number of allowed names. The <code class="docutils literal notranslate"><span class="pre">ed</span></code> template has the definition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">...</span><span class="p">,{</span> <span class="ow">and</span> <span class="p">}</span><span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>which simplifies to <code class="docutils literal notranslate"><span class="pre">&lt;editorname.0&gt;</span></code> when there is only one editor in the database entry, and:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">0</span><span class="o">&gt;</span> <span class="ow">and</span> <span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">1</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>when there are only two. Here the separator `` and `` comes from the <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">and</span> <span class="pre">}</span></code> placed at the right hand side of the implicit loop. For three editors, the implicit loop expands the template to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="ow">and</span> <span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>where this time the comma alone is used as the first delimiter, as it is outside the enclosed braces. For the final element, both the comma and the <code class="docutils literal notranslate"><span class="pre">{</span> <span class="pre">and</span> <span class="pre">}</span></code> at the right hand side of the implicit loop are used as the final delimiter. Since the template does not specify the format for more than three editor names, the code builds an <em>et al.</em> construction when there more than this number of names, so that the result becomes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">1</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">editorname</span><span class="o">.</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span> \<span class="n">textit</span><span class="p">{</span><span class="n">et</span> <span class="n">al</span><span class="o">.</span><span class="p">}</span>
</pre></div>
</div>
<p>where the form of the string <code class="docutils literal notranslate"><span class="pre">\textit{,</span> <span class="pre">et.</span> <span class="pre">al}</span></code> is specified by the <code class="docutils literal notranslate"><span class="pre">etal_message</span></code> keyword option.</p>
<p>Thus, the implicit loop has filled out a unique template based on the number of editors it finds within the database entry. The next step is to use the implicitly-indexed <code class="docutils literal notranslate"><span class="pre">editorname</span></code> to complete building out the template. The latter template is defined as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">editorname</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">][</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">middle</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">]</span><span class="o">...</span>
               <span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">prefix</span><span class="o">&gt;</span> <span class="p">]</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">last</span><span class="o">&gt;</span><span class="p">[,</span> <span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="n">n</span><span class="o">.</span><span class="n">suffix</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>so that a template variable of the form <a href="#id1"><span class="problematic" id="id2">``</span></a>&lt;editorname.0&gt;’’ is replaced with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">first</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">][</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">middle</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">]</span><span class="o">...</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">prefix</span><span class="o">&gt;</span> <span class="p">]</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">last</span><span class="o">&gt;</span><span class="p">[,</span> <span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">suffix</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>That is, the implicit index <code class="docutils literal notranslate"><span class="pre">.n</span></code> is everywhere replaced with the explicit index <code class="docutils literal notranslate"><span class="pre">0</span></code>. For the case of a database entry containing two editor names, the final template will thus have the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">first</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">][</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">middle</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">]</span><span class="o">...</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">prefix</span><span class="o">&gt;</span> <span class="p">]</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">last</span><span class="o">&gt;</span><span class="p">[,</span> <span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">0.</span><span class="n">suffix</span><span class="o">&gt;</span><span class="p">]</span> <span class="ow">and</span> <span class="o">...</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">1.</span><span class="n">first</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">][</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">1.</span><span class="n">middle</span><span class="o">.</span><span class="n">initial</span><span class="p">()</span><span class="o">&gt;.</span> <span class="p">]</span><span class="o">...</span>
<span class="p">[</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">1.</span><span class="n">prefix</span><span class="o">&gt;</span> <span class="p">]</span><span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">1.</span><span class="n">last</span><span class="o">&gt;</span><span class="p">[,</span> <span class="o">&lt;</span><span class="n">editorlist</span><span class="o">.</span><span class="mf">1.</span><span class="n">suffix</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>With this template now complete, the code begins to evaluate the entry and replace the individual variables with their corresponding database fields.</p>
</div>
<div class="section" id="python-api">
<h2>Python API<a class="headerlink" href="#python-api" title="Permalink to this headline">¶</a></h2>
<p>Bibulous also provides to users an extensible Python interface allowing users to directly manipulate Bibulous’ internal data structures. These use the <code class="docutils literal notranslate"><span class="pre">VARIABLES</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFINITIONS</span></code> sections of the file, as shown below. For the <code class="docutils literal notranslate"><span class="pre">`VARIABLES</span></code> section, a variable name is defined (the first example below defines the variable <code class="docutils literal notranslate"><span class="pre">year_bce</span></code>, while the second example below defines <code class="docutils literal notranslate"><span class="pre">pagerange</span></code>). On the right hand side of the definition, however, is a Python function call. This is different from the other sections of the BST file, which use template syntax. Any variable defined in this way within the <code class="docutils literal notranslate"><span class="pre">VARIABLES</span></code> section can then be accessed as a template variable (i.e. <code class="docutils literal notranslate"><span class="pre">&lt;year_bce&gt;</span></code>) within the <code class="docutils literal notranslate"><span class="pre">TEMPLATES</span></code> section of the file. Two example uses are shown below.</p>
<p>To allow Bibulous to read the <code class="docutils literal notranslate"><span class="pre">VARIABLES</span></code> and <code class="docutils literal notranslate"><span class="pre">DEFINITIONS</span></code> sections of the file, users must set the option keyword <code class="docutils literal notranslate"><span class="pre">allow_scripts</span></code> to True.</p>
<p><strong>First example: a custom yearstyle</strong>. For a bibliography containing works from authors dating from before year 0, a common approach is to append “BC” to the year number, and for positive-numbered years, appending “AD”. More recently, the convention has been to append “BCE” and “CE” rather than “BC” and “AD”. The example defines an option keyword <code class="docutils literal notranslate"><span class="pre">yearstyle</span></code> that allows users to switch between one style (BC/AD) and the other (BCE/CE). This keyword is accessed by placing <code class="docutils literal notranslate"><span class="pre">options</span></code> as an argument to the <code class="docutils literal notranslate"><span class="pre">format_yearstyle()</span></code> function defining the variable <code class="docutils literal notranslate"><span class="pre">year_bce</span></code>. Inside the function, it can then check the options dictionary for the <code class="docutils literal notranslate"><span class="pre">yearstyle</span></code> keyword and determine which convention to use.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">format_yearstyle()</span></code> function itself is straightforward. It first checks whether the entry has a <code class="docutils literal notranslate"><span class="pre">year</span></code> field. If not, then it returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, indicating that the function’s result is undefined. If it finds a <code class="docutils literal notranslate"><span class="pre">year</span></code> field, then it checks to see whether it corresponds to an integer. If not, then it returns the field as-is. (Perhaps a user defines his <code class="docutils literal notranslate"><span class="pre">year</span></code> fields as <code class="docutils literal notranslate"><span class="pre">45</span> <span class="pre">BCE</span></code> with the BCE already written out inside the field?) If it finds an integer value, then it determines which style to use (BC/AD or BCE/CE). If the year number is negative then it appends “BC” or “BCE to the end. If the year number is positive then it appends “AD” or “CE to the end, depending on the convention chosen.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OPTIONS</span><span class="p">:</span>
<span class="n">allow_scripts</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">yearstyle</span> <span class="o">=</span> <span class="n">BCE</span><span class="o">/</span><span class="n">CE</span>

<span class="n">VARIABLES</span><span class="p">:</span>
<span class="n">year_bce</span> <span class="o">=</span> <span class="n">format_yearstyle</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

<span class="n">DEFINITIONS</span><span class="p">:</span>
<span class="c1">## NOTE! Only Unix-style line endings are allowed here.</span>
<span class="k">def</span> <span class="nf">format_yearstyle</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Append &quot;BC or &quot;AD&quot; to &quot;year&quot;, depending on whether the year is positive or negative.</span>
<span class="sd">    If the option &quot;yearstyle&quot; is set to &quot;BCE/CE&quot;, then use &quot;BCE&quot; and &quot;CE&quot; instead of &quot;BC&quot;</span>
<span class="sd">    and &quot;AD&quot;.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;year&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;undefstr&#39;</span><span class="p">])</span>

    <span class="c1">## First check that the year string is an integer. If not an integer, then just return</span>
    <span class="c1">## the field itself.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">str_is_integer</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>

    <span class="n">yearnum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">yearnum</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;yearstyle&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BCE/CE&#39;</span><span class="p">):</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;BCE&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;BC&#39;</span>
        <span class="c1">## The &quot;[1:]&quot; here removes the minus sign.</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">yearnum</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">suffix</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">yearnum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">yearnum</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;yearstyle&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BCE/CE&#39;</span><span class="p">):</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;CE&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s1">&#39;AD&#39;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">yearnum</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">suffix</span>

    <span class="k">return</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Second example: a custom pagestyle</strong>. For a bibliography containing works from magazines, it is not uncommon to find articles with large gaps in page numbers. Here is an example bibliography database entry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@article</span><span class="p">{</span><span class="n">stewart</span><span class="p">,</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="n">Interview</span> <span class="k">with</span> <span class="n">Walter</span> <span class="n">Stewart</span><span class="p">},</span>
<span class="n">author</span> <span class="o">=</span> <span class="p">{</span><span class="n">Doug</span> <span class="n">Stewart</span><span class="p">},</span>
<span class="n">journal</span> <span class="o">=</span> <span class="p">{</span><span class="n">Omni</span><span class="p">},</span>
<span class="n">year</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1989</span><span class="p">},</span>
<span class="n">volume</span> <span class="o">=</span> <span class="p">{</span><span class="mi">11</span><span class="p">},</span>
<span class="n">number</span> <span class="o">=</span> <span class="p">{</span><span class="mi">5</span><span class="p">},</span>
<span class="n">pages</span> <span class="o">=</span> <span class="p">{</span><span class="mi">64</span><span class="o">--</span><span class="mi">66</span><span class="p">,</span> <span class="mi">87</span><span class="o">--</span><span class="mi">92</span><span class="p">,</span> <span class="mi">94</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>where we can see that the article was broken into three sections in order to fit the editors’ formatting requirements. Many bibliography styles require a starting and ending page, but these are misleading when the article is broken across pages in this way. Thus, a user may want to have the option that if a comma is found within the <code class="docutils literal notranslate"><span class="pre">pages</span></code> field of an entry then it should be displayed as-is. If no comma is found, then it simply returns the standard startpage–endpage pair.</p>
<p>To make this work, first the option <code class="docutils literal notranslate"><span class="pre">allow_scripts</span></code> must be set to true. Next, a new <code class="docutils literal notranslate"><span class="pre">pagerange</span></code> variable is defined, so that it can be accessed in the <code class="docutils literal notranslate"><span class="pre">TEMPLATES</span></code> section of the file as <code class="docutils literal notranslate"><span class="pre">&lt;pagerange&gt;</span></code>. The variable is defined as the return value of the function <code class="docutils literal notranslate"><span class="pre">format_pagerange()</span></code> given in the <code class="docutils literal notranslate"><span class="pre">DEFINITIONS</span></code> section. The defined function first checks to see if there is a <code class="docutils literal notranslate"><span class="pre">pages</span></code> field defined in the entry. If not, then it returns None, so that the <code class="docutils literal notranslate"><span class="pre">pagerange</span></code> variable will also be undefined. If it finds the <code class="docutils literal notranslate"><span class="pre">pages</span></code> field, it looks to see if there is a comma present. If so, it returns the field as-is. If not, it looks for the <code class="docutils literal notranslate"><span class="pre">endpage</span></code> variable (generated by default by Bibulous from the <code class="docutils literal notranslate"><span class="pre">pages</span></code> field). If present, then the function returns a startpage–endpage pair. If <code class="docutils literal notranslate"><span class="pre">endpage</span></code> is not present, then it returns only the <code class="docutils literal notranslate"><span class="pre">startpage</span></code> variable.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OPTIONS</span><span class="p">:</span>
<span class="n">allow_scripts</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">VARIABLES</span><span class="p">:</span>
<span class="n">pagerange</span> <span class="o">=</span> <span class="n">format_pagerange</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

<span class="n">DEFINITIONS</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">format_pagerange</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    If the &quot;pages&quot; field is comma-delimited, then return the pages field as-is. Otherwise</span>
<span class="sd">    return the standard startpage--endpage range.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s1">&#39;pages&#39;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">[</span><span class="s1">&#39;pages&#39;</span><span class="p">]):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;pages&#39;</span><span class="p">])</span>
    <span class="k">elif</span> <span class="p">(</span><span class="s1">&#39;endpage&#39;</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">):</span>
        <span class="k">return</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;startpage&#39;</span><span class="p">]</span><span class="o">--</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;endpage&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;startpage&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="instructions_for_reporting_bugs.html" title="Instructions on how to report a bug to the Bibulous development team"
             >next</a> |</li>
        <li class="right" >
          <a href="faq.html" title="Frequently asked questions"
             >previous</a> |</li>
        <li><a href="index.html">home</a>|&nbsp;</li>
        <li><a href="search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013, Bibulous developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.
    </div>
  </body>
</html>