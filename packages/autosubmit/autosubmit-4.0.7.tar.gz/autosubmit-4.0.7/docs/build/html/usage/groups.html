
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Grouping jobs &#8212; autosubmit 3.9.1 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to monitor job statistics" href="stats.html" />
    <link rel="prev" title="How to monitor the experiment" href="monitor.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="stats.html" title="How to monitor job statistics"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="monitor.html" title="How to monitor the experiment"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">autosubmit 3.9.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../usage.html" accesskey="U">Usage</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="grouping-jobs">
<span id="grouping"></span><h1>Grouping jobs<a class="headerlink" href="#grouping-jobs" title="Permalink to this headline">Â¶</a></h1>
<p>Other than the filters, another option for large workflows is to group jobs. This option is available with the <code class="docutils literal notranslate"><span class="pre">group_by</span></code> keyword, which can receive the values <code class="docutils literal notranslate"><span class="pre">{date,member,chunk,split,automatic}</span></code>.</p>
<p>For the first 4 options, the grouping criteria is explicitly defined <code class="docutils literal notranslate"><span class="pre">{date,member,chunk,split}</span></code>.
In addition to that, it is possible to expand some dates/members/chunks that would be grouped either/both by status or/and by specifying the date/member/chunk not to group.
The syntax used in this option is almost the same as for the filters, in the format of <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">date1</span> <span class="pre">[</span> <span class="pre">member1</span> <span class="pre">[</span> <span class="pre">chunk1</span> <span class="pre">chunk2</span> <span class="pre">]</span> <span class="pre">member2</span> <span class="pre">[</span> <span class="pre">chunk3</span> <span class="pre">...</span> <span class="pre">]</span> <span class="pre">...</span> <span class="pre">]</span> <span class="pre">date2</span> <span class="pre">[</span> <span class="pre">member3</span> <span class="pre">[</span> <span class="pre">chunk1</span> <span class="pre">]</span> <span class="pre">]</span> <span class="pre">...</span> <span class="pre">]</span></code></p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The grouping option is also in autosubmit monitor, create, setstatus and recovery</p>
</div>
<p>Examples:</p>
<p>Consider the following workflow:</p>
<div class="figure align-center" id="pre-grouping-workflow">
<img alt="simple workflow" src="../_images/pre_grouping_workflow.png" />
</div>
<p><strong>Group by date</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">date</span>
</pre></div>
</div>
<div class="figure align-center" id="group-date">
<a class="reference internal image-reference" href="../_images/group_date.png"><img alt="group date" src="../_images/group_date.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">date</span> <span class="o">-</span><span class="n">expand</span><span class="o">=</span><span class="s2">&quot;[ 20000101 ]&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-date-expand">
<a class="reference internal image-reference" href="../_images/group_by_date_expand.png"><img alt="group date expand" src="../_images/group_by_date_expand.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">date</span> <span class="o">-</span><span class="n">expand_status</span><span class="o">=</span><span class="s2">&quot;FAILED RUNNING&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-date-status-expand">
<a class="reference internal image-reference" href="../_images/group_by_date_status.png"><img alt="group date expand status" src="../_images/group_by_date_status.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">date</span> <span class="o">-</span><span class="n">expand</span><span class="o">=</span><span class="s2">&quot;[ 20000101 ]&quot;</span> <span class="o">-</span><span class="n">expand_status</span><span class="o">=</span><span class="s2">&quot;FAILED RUNNING&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-date-expand-status">
<a class="reference internal image-reference" href="../_images/group_by_date_status_expand.png"><img alt="group date expand status" src="../_images/group_by_date_status_expand.png" style="width: 100%;" /></a>
</div>
<p><strong>Group by member</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">member</span>
</pre></div>
</div>
<div class="figure align-center" id="group-member">
<a class="reference internal image-reference" href="../_images/group_member.png"><img alt="group member" src="../_images/group_member.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">member</span> <span class="o">-</span><span class="n">expand</span><span class="o">=</span><span class="s2">&quot;[ 20000101 [ fc0 fc1 ] 20000202 [ fc0 ] ]&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-member-expand">
<a class="reference internal image-reference" href="../_images/group_by_member_expand.png"><img alt="group member expand" src="../_images/group_by_member_expand.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">member</span> <span class="o">-</span><span class="n">expand_status</span><span class="o">=</span><span class="s2">&quot;FAILED QUEUING&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-member-status">
<a class="reference internal image-reference" href="../_images/group_by_member_status.png"><img alt="group member expand" src="../_images/group_by_member_status.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">member</span> <span class="o">-</span><span class="n">expand</span><span class="o">=</span><span class="s2">&quot;[ 20000101 [ fc0 fc1 ] 20000202 [ fc0 ] ]&quot;</span> <span class="o">-</span><span class="n">expand_status</span><span class="o">=</span><span class="s2">&quot;FAILED QUEUING&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-member-expand-status">
<a class="reference internal image-reference" href="../_images/group_by_member_expand_status.png"><img alt="group member expand" src="../_images/group_by_member_expand_status.png" style="width: 70%;" /></a>
</div>
<p><strong>Group by chunk</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">chunk</span>
</pre></div>
</div>
<div class="figure align-center" id="group-chunk">
<a class="reference internal image-reference" href="../_images/group_chunk.png"><img alt="group chunk" src="../_images/group_chunk.png" style="width: 70%;" /></a>
</div>
<p>Sychronize jobs</p>
<p>If there are jobs synchronized between members or dates, then a connection between groups is shown:</p>
<div class="figure align-center" id="group-synchronize">
<a class="reference internal image-reference" href="../_images/group_synchronize.png"><img alt="group synchronize" src="../_images/group_synchronize.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">chunk</span> <span class="o">-</span><span class="n">expand</span><span class="o">=</span><span class="s2">&quot;[ 20000101 [ fc0 [1 2] ] 20000202 [ fc1 [2] ] ]&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-chunk-expand">
<a class="reference internal image-reference" href="../_images/group_by_chunk_expand.png"><img alt="group chunk expand" src="../_images/group_by_chunk_expand.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">chunk</span> <span class="o">-</span><span class="n">expand_status</span><span class="o">=</span><span class="s2">&quot;FAILED RUNNING&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-chunk-status">
<a class="reference internal image-reference" href="../_images/group_by_chunk_status.png"><img alt="group chunk expand" src="../_images/group_by_chunk_status.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">chunk</span> <span class="o">-</span><span class="n">expand</span><span class="o">=</span><span class="s2">&quot;[ 20000101 [ fc0 [1] ] 20000202 [ fc1 [1 2] ] ]&quot;</span> <span class="o">-</span><span class="n">expand_status</span><span class="o">=</span><span class="s2">&quot;FAILED RUNNING&quot;</span>
</pre></div>
</div>
<div class="figure align-center" id="group-chunk-expand-status">
<a class="reference internal image-reference" href="../_images/group_by_chunk_expand_status.png"><img alt="group chunk expand" src="../_images/group_by_chunk_expand_status.png" style="width: 70%;" /></a>
</div>
<p><strong>Group by split</strong></p>
<p>If there are chunk jobs that are split, the splits can also be grouped.</p>
<div class="figure align-center" id="split-workflow">
<a class="reference internal image-reference" href="../_images/split_workflow.png"><img alt="split workflow" src="../_images/split_workflow.png" style="width: 70%;" /></a>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">split</span>
</pre></div>
</div>
<div class="figure align-center" id="group-split">
<a class="reference internal image-reference" href="../_images/split_group.png"><img alt="group split" src="../_images/split_group.png" style="width: 70%;" /></a>
</div>
<p><strong>Understading the group status</strong></p>
<p>If there are jobs with different status grouped together, the status of the group is determined as follows:
If there is at least one job that failed, the status of the group will be FAILED. If there are no failures, but if there is at least one job running, the status will be RUNNING.
The same idea applies following the hierarchy: SUBMITTED, QUEUING, READY, WAITING, SUSPENDED, UNKNOWN. If the group status is COMPLETED, it means that all jobs in the group were completed.</p>
<p><strong>Automatic grouping</strong></p>
<p>For the automatic grouping, the groups are created by collapsing the split-&gt;chunk-&gt;member-&gt;date that share the same status (following this hierarchy).
The following workflow automatic created the groups 20000101_fc0, since all the jobs for this date and member were completed, 20000101_fc1_3, 20000202_fc0_2, 20000202_fc0_3 and 20000202_fc1, as all the jobs up to the respective group granularities share the same - waiting - status.</p>
<p>For example:</p>
<div class="figure align-center" id="group-automatic">
<a class="reference internal image-reference" href="../_images/group_automatic.png"><img alt="group automatic" src="../_images/group_automatic.png" style="width: 70%;" /></a>
</div>
<p>Especially in the case of monitoring an experiment with a very large number of chunks, it might be useful to hide the groups created automatically. This allows to better visualize the chunks in which there are jobs with different status, which can be a good indication that there is something currently happening within such chunks (jobs ready, submitted, running, queueing or failed).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">group_by</span><span class="o">=</span><span class="n">automatic</span> <span class="o">--</span><span class="n">hide_groups</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="monitor.html"
                        title="previous chapter">How to monitor the experiment</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="stats.html"
                        title="next chapter">How to monitor job statistics</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/usage/groups.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="stats.html" title="How to monitor job statistics"
             >next</a> |</li>
        <li class="right" >
          <a href="monitor.html" title="How to monitor the experiment"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">autosubmit 3.9.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../usage.html" >Usage</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018-2020, Barcelona Supercomputing Center, BSC.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>