"use strict";
(self["webpackChunk_jupyterlab_application_top"] = self["webpackChunk_jupyterlab_application_top"] || []).push([["node_modules_codemirror_legacy-modes_mode_stex_js"],{

/***/ "./node_modules/@codemirror/legacy-modes/mode/stex.js":
/*!************************************************************!*\
  !*** ./node_modules/@codemirror/legacy-modes/mode/stex.js ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "stex": () => (/* binding */ stex),
/* harmony export */   "stexMath": () => (/* binding */ stexMath)
/* harmony export */ });
function mkStex(mathMode) {
  function pushCommand(state, command) {
    state.cmdState.push(command);
  }

  function peekCommand(state) {
    if (state.cmdState.length > 0) {
      return state.cmdState[state.cmdState.length - 1];
    } else {
      return null;
    }
  }

  function popCommand(state) {
    var plug = state.cmdState.pop();
    if (plug) {
      plug.closeBracket();
    }
  }

  // returns the non-default plugin closest to the end of the list
  function getMostPowerful(state) {
    var context = state.cmdState;
    for (var i = context.length - 1; i >= 0; i--) {
      var plug = context[i];
      if (plug.name == "DEFAULT") {
        continue;
      }
      return plug;
    }
    return { styleIdentifier: function() { return null; } };
  }

  function addPluginPattern(pluginName, cmdStyle, styles) {
    return function () {
      this.name = pluginName;
      this.bracketNo = 0;
      this.style = cmdStyle;
      this.styles = styles;
      this.argument = null;   // \begin and \end have arguments that follow. These are stored in the plugin

      this.styleIdentifier = function() {
        return this.styles[this.bracketNo - 1] || null;
      };
      this.openBracket = function() {
        this.bracketNo++;
        return "bracket";
      };
      this.closeBracket = function() {};
    };
  }

  var plugins = {};

  plugins["importmodule"] = addPluginPattern("importmodule", "tag", ["string", "builtin"]);
  plugins["documentclass"] = addPluginPattern("documentclass", "tag", ["", "atom"]);
  plugins["usepackage"] = addPluginPattern("usepackage", "tag", ["atom"]);
  plugins["begin"] = addPluginPattern("begin", "tag", ["atom"]);
  plugins["end"] = addPluginPattern("end", "tag", ["atom"]);

  plugins["label"    ] = addPluginPattern("label"    , "tag", ["atom"]);
  plugins["ref"      ] = addPluginPattern("ref"      , "tag", ["atom"]);
  plugins["eqref"    ] = addPluginPattern("eqref"    , "tag", ["atom"]);
  plugins["cite"     ] = addPluginPattern("cite"     , "tag", ["atom"]);
  plugins["bibitem"  ] = addPluginPattern("bibitem"  , "tag", ["atom"]);
  plugins["Bibitem"  ] = addPluginPattern("Bibitem"  , "tag", ["atom"]);
  plugins["RBibitem" ] = addPluginPattern("RBibitem" , "tag", ["atom"]);

  plugins["DEFAULT"] = function () {
    this.name = "DEFAULT";
    this.style = "tag";

    this.styleIdentifier = this.openBracket = this.closeBracket = function() {};
  };

  function setState(state, f) {
    state.f = f;
  }

  // called when in a normal (no environment) context
  function normal(source, state) {
    var plug;
    // Do we look like '\command' ?  If so, attempt to apply the plugin 'command'
    if (source.match(/^\\[a-zA-Z@]+/)) {
      var cmdName = source.current().slice(1);
      plug = plugins.hasOwnProperty(cmdName) ? plugins[cmdName] : plugins["DEFAULT"];
      plug = new plug();
      pushCommand(state, plug);
      setState(state, beginParams);
      return plug.style;
    }

    // escape characters
    if (source.match(/^\\[$&%#{}_]/)) {
      return "tag";
    }

    // white space control characters
    if (source.match(/^\\[,;!\/\\]/)) {
      return "tag";
    }

    // find if we're starting various math modes
    if (source.match("\\[")) {
      setState(state, function(source, state){ return inMathMode(source, state, "\\]"); });
      return "keyword";
    }
    if (source.match("\\(")) {
      setState(state, function(source, state){ return inMathMode(source, state, "\\)"); });
      return "keyword";
    }
    if (source.match("$$")) {
      setState(state, function(source, state){ return inMathMode(source, state, "$$"); });
      return "keyword";
    }
    if (source.match("$")) {
      setState(state, function(source, state){ return inMathMode(source, state, "$"); });
      return "keyword";
    }

    var ch = source.next();
    if (ch == "%") {
      source.skipToEnd();
      return "comment";
    } else if (ch == '}' || ch == ']') {
      plug = peekCommand(state);
      if (plug) {
        plug.closeBracket(ch);
        setState(state, beginParams);
      } else {
        return "error";
      }
      return "bracket";
    } else if (ch == '{' || ch == '[') {
      plug = plugins["DEFAULT"];
      plug = new plug();
      pushCommand(state, plug);
      return "bracket";
    } else if (/\d/.test(ch)) {
      source.eatWhile(/[\w.%]/);
      return "atom";
    } else {
      source.eatWhile(/[\w\-_]/);
      plug = getMostPowerful(state);
      if (plug.name == 'begin') {
        plug.argument = source.current();
      }
      return plug.styleIdentifier();
    }
  }

  function inMathMode(source, state, endModeSeq) {
    if (source.eatSpace()) {
      return null;
    }
    if (endModeSeq && source.match(endModeSeq)) {
      setState(state, normal);
      return "keyword";
    }
    if (source.match(/^\\[a-zA-Z@]+/)) {
      return "tag";
    }
    if (source.match(/^[a-zA-Z]+/)) {
      return "variableName.special";
    }
    // escape characters
    if (source.match(/^\\[$&%#{}_]/)) {
      return "tag";
    }
    // white space control characters
    if (source.match(/^\\[,;!\/]/)) {
      return "tag";
    }
    // special math-mode characters
    if (source.match(/^[\^_&]/)) {
      return "tag";
    }
    // non-special characters
    if (source.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)) {
      return null;
    }
    if (source.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)) {
      return "number";
    }
    var ch = source.next();
    if (ch == "{" || ch == "}" || ch == "[" || ch == "]" || ch == "(" || ch == ")") {
      return "bracket";
    }

    if (ch == "%") {
      source.skipToEnd();
      return "comment";
    }
    return "error";
  }

  function beginParams(source, state) {
    var ch = source.peek(), lastPlug;
    if (ch == '{' || ch == '[') {
      lastPlug = peekCommand(state);
      lastPlug.openBracket(ch);
      source.eat(ch);
      setState(state, normal);
      return "bracket";
    }
    if (/[ \t\r]/.test(ch)) {
      source.eat(ch);
      return null;
    }
    setState(state, normal);
    popCommand(state);

    return normal(source, state);
  }

  return {
    startState: function() {
      var f = mathMode ? function(source, state){ return inMathMode(source, state); } : normal;
      return {
        cmdState: [],
        f: f
      };
    },
    copyState: function(s) {
      return {
        cmdState: s.cmdState.slice(),
        f: s.f
      };
    },
    token: function(stream, state) {
      return state.f(stream, state);
    },
    blankLine: function(state) {
      state.f = normal;
      state.cmdState.length = 0;
    },
    languageData: {
      commentTokens: {line: "%"}
    }
  };
};

const stex = mkStex(false)
const stexMath = mkStex(true)


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibm9kZV9tb2R1bGVzX2NvZGVtaXJyb3JfbGVnYWN5LW1vZGVzX21vZGVfc3RleF9qcy40Zjc4ODcyYzBkODIzZWQ3Y2MwYy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxRQUFRO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsOEJBQThCO0FBQzNDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qjs7QUFFOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7O0FBRUE7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsK0NBQStDLDBDQUEwQztBQUN6RjtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsMENBQTBDO0FBQ3pGO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyx5Q0FBeUM7QUFDeEY7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLHdDQUF3QztBQUN2RjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSxpQkFBaUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0EsTUFBTSxpQkFBaUI7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1Q0FBdUM7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGFBQWE7QUFDN0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0RBQWtELG9DQUFvQztBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTs7QUFFTztBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQGp1cHl0ZXJsYWIvYXBwbGljYXRpb24tdG9wLy4vbm9kZV9tb2R1bGVzL0Bjb2RlbWlycm9yL2xlZ2FjeS1tb2Rlcy9tb2RlL3N0ZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbWtTdGV4KG1hdGhNb2RlKSB7XG4gIGZ1bmN0aW9uIHB1c2hDb21tYW5kKHN0YXRlLCBjb21tYW5kKSB7XG4gICAgc3RhdGUuY21kU3RhdGUucHVzaChjb21tYW5kKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHBlZWtDb21tYW5kKHN0YXRlKSB7XG4gICAgaWYgKHN0YXRlLmNtZFN0YXRlLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBzdGF0ZS5jbWRTdGF0ZVtzdGF0ZS5jbWRTdGF0ZS5sZW5ndGggLSAxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gcG9wQ29tbWFuZChzdGF0ZSkge1xuICAgIHZhciBwbHVnID0gc3RhdGUuY21kU3RhdGUucG9wKCk7XG4gICAgaWYgKHBsdWcpIHtcbiAgICAgIHBsdWcuY2xvc2VCcmFja2V0KCk7XG4gICAgfVxuICB9XG5cbiAgLy8gcmV0dXJucyB0aGUgbm9uLWRlZmF1bHQgcGx1Z2luIGNsb3Nlc3QgdG8gdGhlIGVuZCBvZiB0aGUgbGlzdFxuICBmdW5jdGlvbiBnZXRNb3N0UG93ZXJmdWwoc3RhdGUpIHtcbiAgICB2YXIgY29udGV4dCA9IHN0YXRlLmNtZFN0YXRlO1xuICAgIGZvciAodmFyIGkgPSBjb250ZXh0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICB2YXIgcGx1ZyA9IGNvbnRleHRbaV07XG4gICAgICBpZiAocGx1Zy5uYW1lID09IFwiREVGQVVMVFwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBsdWc7XG4gICAgfVxuICAgIHJldHVybiB7IHN0eWxlSWRlbnRpZmllcjogZnVuY3Rpb24oKSB7IHJldHVybiBudWxsOyB9IH07XG4gIH1cblxuICBmdW5jdGlvbiBhZGRQbHVnaW5QYXR0ZXJuKHBsdWdpbk5hbWUsIGNtZFN0eWxlLCBzdHlsZXMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5uYW1lID0gcGx1Z2luTmFtZTtcbiAgICAgIHRoaXMuYnJhY2tldE5vID0gMDtcbiAgICAgIHRoaXMuc3R5bGUgPSBjbWRTdHlsZTtcbiAgICAgIHRoaXMuc3R5bGVzID0gc3R5bGVzO1xuICAgICAgdGhpcy5hcmd1bWVudCA9IG51bGw7ICAgLy8gXFxiZWdpbiBhbmQgXFxlbmQgaGF2ZSBhcmd1bWVudHMgdGhhdCBmb2xsb3cuIFRoZXNlIGFyZSBzdG9yZWQgaW4gdGhlIHBsdWdpblxuXG4gICAgICB0aGlzLnN0eWxlSWRlbnRpZmllciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdHlsZXNbdGhpcy5icmFja2V0Tm8gLSAxXSB8fCBudWxsO1xuICAgICAgfTtcbiAgICAgIHRoaXMub3BlbkJyYWNrZXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5icmFja2V0Tm8rKztcbiAgICAgICAgcmV0dXJuIFwiYnJhY2tldFwiO1xuICAgICAgfTtcbiAgICAgIHRoaXMuY2xvc2VCcmFja2V0ID0gZnVuY3Rpb24oKSB7fTtcbiAgICB9O1xuICB9XG5cbiAgdmFyIHBsdWdpbnMgPSB7fTtcblxuICBwbHVnaW5zW1wiaW1wb3J0bW9kdWxlXCJdID0gYWRkUGx1Z2luUGF0dGVybihcImltcG9ydG1vZHVsZVwiLCBcInRhZ1wiLCBbXCJzdHJpbmdcIiwgXCJidWlsdGluXCJdKTtcbiAgcGx1Z2luc1tcImRvY3VtZW50Y2xhc3NcIl0gPSBhZGRQbHVnaW5QYXR0ZXJuKFwiZG9jdW1lbnRjbGFzc1wiLCBcInRhZ1wiLCBbXCJcIiwgXCJhdG9tXCJdKTtcbiAgcGx1Z2luc1tcInVzZXBhY2thZ2VcIl0gPSBhZGRQbHVnaW5QYXR0ZXJuKFwidXNlcGFja2FnZVwiLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcbiAgcGx1Z2luc1tcImJlZ2luXCJdID0gYWRkUGx1Z2luUGF0dGVybihcImJlZ2luXCIsIFwidGFnXCIsIFtcImF0b21cIl0pO1xuICBwbHVnaW5zW1wiZW5kXCJdID0gYWRkUGx1Z2luUGF0dGVybihcImVuZFwiLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcblxuICBwbHVnaW5zW1wibGFiZWxcIiAgICBdID0gYWRkUGx1Z2luUGF0dGVybihcImxhYmVsXCIgICAgLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcbiAgcGx1Z2luc1tcInJlZlwiICAgICAgXSA9IGFkZFBsdWdpblBhdHRlcm4oXCJyZWZcIiAgICAgICwgXCJ0YWdcIiwgW1wiYXRvbVwiXSk7XG4gIHBsdWdpbnNbXCJlcXJlZlwiICAgIF0gPSBhZGRQbHVnaW5QYXR0ZXJuKFwiZXFyZWZcIiAgICAsIFwidGFnXCIsIFtcImF0b21cIl0pO1xuICBwbHVnaW5zW1wiY2l0ZVwiICAgICBdID0gYWRkUGx1Z2luUGF0dGVybihcImNpdGVcIiAgICAgLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcbiAgcGx1Z2luc1tcImJpYml0ZW1cIiAgXSA9IGFkZFBsdWdpblBhdHRlcm4oXCJiaWJpdGVtXCIgICwgXCJ0YWdcIiwgW1wiYXRvbVwiXSk7XG4gIHBsdWdpbnNbXCJCaWJpdGVtXCIgIF0gPSBhZGRQbHVnaW5QYXR0ZXJuKFwiQmliaXRlbVwiICAsIFwidGFnXCIsIFtcImF0b21cIl0pO1xuICBwbHVnaW5zW1wiUkJpYml0ZW1cIiBdID0gYWRkUGx1Z2luUGF0dGVybihcIlJCaWJpdGVtXCIgLCBcInRhZ1wiLCBbXCJhdG9tXCJdKTtcblxuICBwbHVnaW5zW1wiREVGQVVMVFwiXSA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLm5hbWUgPSBcIkRFRkFVTFRcIjtcbiAgICB0aGlzLnN0eWxlID0gXCJ0YWdcIjtcblxuICAgIHRoaXMuc3R5bGVJZGVudGlmaWVyID0gdGhpcy5vcGVuQnJhY2tldCA9IHRoaXMuY2xvc2VCcmFja2V0ID0gZnVuY3Rpb24oKSB7fTtcbiAgfTtcblxuICBmdW5jdGlvbiBzZXRTdGF0ZShzdGF0ZSwgZikge1xuICAgIHN0YXRlLmYgPSBmO1xuICB9XG5cbiAgLy8gY2FsbGVkIHdoZW4gaW4gYSBub3JtYWwgKG5vIGVudmlyb25tZW50KSBjb250ZXh0XG4gIGZ1bmN0aW9uIG5vcm1hbChzb3VyY2UsIHN0YXRlKSB7XG4gICAgdmFyIHBsdWc7XG4gICAgLy8gRG8gd2UgbG9vayBsaWtlICdcXGNvbW1hbmQnID8gIElmIHNvLCBhdHRlbXB0IHRvIGFwcGx5IHRoZSBwbHVnaW4gJ2NvbW1hbmQnXG4gICAgaWYgKHNvdXJjZS5tYXRjaCgvXlxcXFxbYS16QS1aQF0rLykpIHtcbiAgICAgIHZhciBjbWROYW1lID0gc291cmNlLmN1cnJlbnQoKS5zbGljZSgxKTtcbiAgICAgIHBsdWcgPSBwbHVnaW5zLmhhc093blByb3BlcnR5KGNtZE5hbWUpID8gcGx1Z2luc1tjbWROYW1lXSA6IHBsdWdpbnNbXCJERUZBVUxUXCJdO1xuICAgICAgcGx1ZyA9IG5ldyBwbHVnKCk7XG4gICAgICBwdXNoQ29tbWFuZChzdGF0ZSwgcGx1Zyk7XG4gICAgICBzZXRTdGF0ZShzdGF0ZSwgYmVnaW5QYXJhbXMpO1xuICAgICAgcmV0dXJuIHBsdWcuc3R5bGU7XG4gICAgfVxuXG4gICAgLy8gZXNjYXBlIGNoYXJhY3RlcnNcbiAgICBpZiAoc291cmNlLm1hdGNoKC9eXFxcXFskJiUje31fXS8pKSB7XG4gICAgICByZXR1cm4gXCJ0YWdcIjtcbiAgICB9XG5cbiAgICAvLyB3aGl0ZSBzcGFjZSBjb250cm9sIGNoYXJhY3RlcnNcbiAgICBpZiAoc291cmNlLm1hdGNoKC9eXFxcXFssOyFcXC9cXFxcXS8pKSB7XG4gICAgICByZXR1cm4gXCJ0YWdcIjtcbiAgICB9XG5cbiAgICAvLyBmaW5kIGlmIHdlJ3JlIHN0YXJ0aW5nIHZhcmlvdXMgbWF0aCBtb2Rlc1xuICAgIGlmIChzb3VyY2UubWF0Y2goXCJcXFxcW1wiKSkge1xuICAgICAgc2V0U3RhdGUoc3RhdGUsIGZ1bmN0aW9uKHNvdXJjZSwgc3RhdGUpeyByZXR1cm4gaW5NYXRoTW9kZShzb3VyY2UsIHN0YXRlLCBcIlxcXFxdXCIpOyB9KTtcbiAgICAgIHJldHVybiBcImtleXdvcmRcIjtcbiAgICB9XG4gICAgaWYgKHNvdXJjZS5tYXRjaChcIlxcXFwoXCIpKSB7XG4gICAgICBzZXRTdGF0ZShzdGF0ZSwgZnVuY3Rpb24oc291cmNlLCBzdGF0ZSl7IHJldHVybiBpbk1hdGhNb2RlKHNvdXJjZSwgc3RhdGUsIFwiXFxcXClcIik7IH0pO1xuICAgICAgcmV0dXJuIFwia2V5d29yZFwiO1xuICAgIH1cbiAgICBpZiAoc291cmNlLm1hdGNoKFwiJCRcIikpIHtcbiAgICAgIHNldFN0YXRlKHN0YXRlLCBmdW5jdGlvbihzb3VyY2UsIHN0YXRlKXsgcmV0dXJuIGluTWF0aE1vZGUoc291cmNlLCBzdGF0ZSwgXCIkJFwiKTsgfSk7XG4gICAgICByZXR1cm4gXCJrZXl3b3JkXCI7XG4gICAgfVxuICAgIGlmIChzb3VyY2UubWF0Y2goXCIkXCIpKSB7XG4gICAgICBzZXRTdGF0ZShzdGF0ZSwgZnVuY3Rpb24oc291cmNlLCBzdGF0ZSl7IHJldHVybiBpbk1hdGhNb2RlKHNvdXJjZSwgc3RhdGUsIFwiJFwiKTsgfSk7XG4gICAgICByZXR1cm4gXCJrZXl3b3JkXCI7XG4gICAgfVxuXG4gICAgdmFyIGNoID0gc291cmNlLm5leHQoKTtcbiAgICBpZiAoY2ggPT0gXCIlXCIpIHtcbiAgICAgIHNvdXJjZS5za2lwVG9FbmQoKTtcbiAgICAgIHJldHVybiBcImNvbW1lbnRcIjtcbiAgICB9IGVsc2UgaWYgKGNoID09ICd9JyB8fCBjaCA9PSAnXScpIHtcbiAgICAgIHBsdWcgPSBwZWVrQ29tbWFuZChzdGF0ZSk7XG4gICAgICBpZiAocGx1Zykge1xuICAgICAgICBwbHVnLmNsb3NlQnJhY2tldChjaCk7XG4gICAgICAgIHNldFN0YXRlKHN0YXRlLCBiZWdpblBhcmFtcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gXCJlcnJvclwiO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFwiYnJhY2tldFwiO1xuICAgIH0gZWxzZSBpZiAoY2ggPT0gJ3snIHx8IGNoID09ICdbJykge1xuICAgICAgcGx1ZyA9IHBsdWdpbnNbXCJERUZBVUxUXCJdO1xuICAgICAgcGx1ZyA9IG5ldyBwbHVnKCk7XG4gICAgICBwdXNoQ29tbWFuZChzdGF0ZSwgcGx1Zyk7XG4gICAgICByZXR1cm4gXCJicmFja2V0XCI7XG4gICAgfSBlbHNlIGlmICgvXFxkLy50ZXN0KGNoKSkge1xuICAgICAgc291cmNlLmVhdFdoaWxlKC9bXFx3LiVdLyk7XG4gICAgICByZXR1cm4gXCJhdG9tXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNvdXJjZS5lYXRXaGlsZSgvW1xcd1xcLV9dLyk7XG4gICAgICBwbHVnID0gZ2V0TW9zdFBvd2VyZnVsKHN0YXRlKTtcbiAgICAgIGlmIChwbHVnLm5hbWUgPT0gJ2JlZ2luJykge1xuICAgICAgICBwbHVnLmFyZ3VtZW50ID0gc291cmNlLmN1cnJlbnQoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwbHVnLnN0eWxlSWRlbnRpZmllcigpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGluTWF0aE1vZGUoc291cmNlLCBzdGF0ZSwgZW5kTW9kZVNlcSkge1xuICAgIGlmIChzb3VyY2UuZWF0U3BhY2UoKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmIChlbmRNb2RlU2VxICYmIHNvdXJjZS5tYXRjaChlbmRNb2RlU2VxKSkge1xuICAgICAgc2V0U3RhdGUoc3RhdGUsIG5vcm1hbCk7XG4gICAgICByZXR1cm4gXCJrZXl3b3JkXCI7XG4gICAgfVxuICAgIGlmIChzb3VyY2UubWF0Y2goL15cXFxcW2EtekEtWkBdKy8pKSB7XG4gICAgICByZXR1cm4gXCJ0YWdcIjtcbiAgICB9XG4gICAgaWYgKHNvdXJjZS5tYXRjaCgvXlthLXpBLVpdKy8pKSB7XG4gICAgICByZXR1cm4gXCJ2YXJpYWJsZU5hbWUuc3BlY2lhbFwiO1xuICAgIH1cbiAgICAvLyBlc2NhcGUgY2hhcmFjdGVyc1xuICAgIGlmIChzb3VyY2UubWF0Y2goL15cXFxcWyQmJSN7fV9dLykpIHtcbiAgICAgIHJldHVybiBcInRhZ1wiO1xuICAgIH1cbiAgICAvLyB3aGl0ZSBzcGFjZSBjb250cm9sIGNoYXJhY3RlcnNcbiAgICBpZiAoc291cmNlLm1hdGNoKC9eXFxcXFssOyFcXC9dLykpIHtcbiAgICAgIHJldHVybiBcInRhZ1wiO1xuICAgIH1cbiAgICAvLyBzcGVjaWFsIG1hdGgtbW9kZSBjaGFyYWN0ZXJzXG4gICAgaWYgKHNvdXJjZS5tYXRjaCgvXltcXF5fJl0vKSkge1xuICAgICAgcmV0dXJuIFwidGFnXCI7XG4gICAgfVxuICAgIC8vIG5vbi1zcGVjaWFsIGNoYXJhY3RlcnNcbiAgICBpZiAoc291cmNlLm1hdGNoKC9eWytcXC08Pnw9LFxcL0AhKjo7J1wiYH4jP10vKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmIChzb3VyY2UubWF0Y2goL14oXFxkK1xcLlxcZCp8XFxkKlxcLlxcZCt8XFxkKykvKSkge1xuICAgICAgcmV0dXJuIFwibnVtYmVyXCI7XG4gICAgfVxuICAgIHZhciBjaCA9IHNvdXJjZS5uZXh0KCk7XG4gICAgaWYgKGNoID09IFwie1wiIHx8IGNoID09IFwifVwiIHx8IGNoID09IFwiW1wiIHx8IGNoID09IFwiXVwiIHx8IGNoID09IFwiKFwiIHx8IGNoID09IFwiKVwiKSB7XG4gICAgICByZXR1cm4gXCJicmFja2V0XCI7XG4gICAgfVxuXG4gICAgaWYgKGNoID09IFwiJVwiKSB7XG4gICAgICBzb3VyY2Uuc2tpcFRvRW5kKCk7XG4gICAgICByZXR1cm4gXCJjb21tZW50XCI7XG4gICAgfVxuICAgIHJldHVybiBcImVycm9yXCI7XG4gIH1cblxuICBmdW5jdGlvbiBiZWdpblBhcmFtcyhzb3VyY2UsIHN0YXRlKSB7XG4gICAgdmFyIGNoID0gc291cmNlLnBlZWsoKSwgbGFzdFBsdWc7XG4gICAgaWYgKGNoID09ICd7JyB8fCBjaCA9PSAnWycpIHtcbiAgICAgIGxhc3RQbHVnID0gcGVla0NvbW1hbmQoc3RhdGUpO1xuICAgICAgbGFzdFBsdWcub3BlbkJyYWNrZXQoY2gpO1xuICAgICAgc291cmNlLmVhdChjaCk7XG4gICAgICBzZXRTdGF0ZShzdGF0ZSwgbm9ybWFsKTtcbiAgICAgIHJldHVybiBcImJyYWNrZXRcIjtcbiAgICB9XG4gICAgaWYgKC9bIFxcdFxccl0vLnRlc3QoY2gpKSB7XG4gICAgICBzb3VyY2UuZWF0KGNoKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBzZXRTdGF0ZShzdGF0ZSwgbm9ybWFsKTtcbiAgICBwb3BDb21tYW5kKHN0YXRlKTtcblxuICAgIHJldHVybiBub3JtYWwoc291cmNlLCBzdGF0ZSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHN0YXJ0U3RhdGU6IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGYgPSBtYXRoTW9kZSA/IGZ1bmN0aW9uKHNvdXJjZSwgc3RhdGUpeyByZXR1cm4gaW5NYXRoTW9kZShzb3VyY2UsIHN0YXRlKTsgfSA6IG5vcm1hbDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNtZFN0YXRlOiBbXSxcbiAgICAgICAgZjogZlxuICAgICAgfTtcbiAgICB9LFxuICAgIGNvcHlTdGF0ZTogZnVuY3Rpb24ocykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY21kU3RhdGU6IHMuY21kU3RhdGUuc2xpY2UoKSxcbiAgICAgICAgZjogcy5mXG4gICAgICB9O1xuICAgIH0sXG4gICAgdG9rZW46IGZ1bmN0aW9uKHN0cmVhbSwgc3RhdGUpIHtcbiAgICAgIHJldHVybiBzdGF0ZS5mKHN0cmVhbSwgc3RhdGUpO1xuICAgIH0sXG4gICAgYmxhbmtMaW5lOiBmdW5jdGlvbihzdGF0ZSkge1xuICAgICAgc3RhdGUuZiA9IG5vcm1hbDtcbiAgICAgIHN0YXRlLmNtZFN0YXRlLmxlbmd0aCA9IDA7XG4gICAgfSxcbiAgICBsYW5ndWFnZURhdGE6IHtcbiAgICAgIGNvbW1lbnRUb2tlbnM6IHtsaW5lOiBcIiVcIn1cbiAgICB9XG4gIH07XG59O1xuXG5leHBvcnQgY29uc3Qgc3RleCA9IG1rU3RleChmYWxzZSlcbmV4cG9ydCBjb25zdCBzdGV4TWF0aCA9IG1rU3RleCh0cnVlKVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9