import{d as L,f as M,c as o,I as O,r as Q,s as b,a4 as Z,av as y,J as j,a,w as s,b as E,N as G,e as c,o as n,h as e,aw as H,k as r,g as i,ax as K,ay as g,n as X,az as Y,C as ee,a8 as ue,D as te,ai as oe}from"./index.0bc657b0.js";import{u as se}from"./useToast.68a18afa.js";import{u as ae}from"./usePageTitle.5e5763d0.js";const ne={class:"work-queue__upcoming-runs"},we=L({__name:"WorkQueue",setup(re){const q=E(),v=M(),R=se(),C=o(()=>{const t=["Upcoming Runs","Runs"];return G.xl||t.unshift("Details"),t}),h=O("workQueueId"),x=o(()=>`prefect agent start ${u.value?` --work-queue "${u.value.name}"`:""}`),w=Q([]),d=Q(),F=()=>{w.value=["running","pending"],d.value="Runs"},W={interval:3e5},_=b(v.workQueues.getWorkQueue,[h.value],W),u=o(()=>_.response),f=o(()=>{var t;return(t=u.value)==null?void 0:t.concurrencyLimit}),N=o(()=>{var t;return(t=u.value)==null?void 0:t.isPaused}),m=o(()=>!!(f.value&&f.value<=S.value&&!N.value)),p=o(()=>u.value?[u.value.name]:[]),T=Z({workQueues:p}),U=y({workQueues:p}),B=o(()=>m.value?U.value:T.value),P=()=>{q.push(te.workQueues())},V=o(()=>u.value?`Work Queue: ${u.value.name}`:"Work Queue");ae(V);const D=y({states:["Running","Pending"],workQueues:p}),I=b(v.flowRuns.getFlowRunsCount,[D.value],{interval:3e4}),S=o(()=>{var t;return(t=I.response)!=null?t:[]});return j(()=>{var t;return(t=u.value)==null?void 0:t.deprecated},t=>{t&&R(oe.info.deprecatedWorkQueue,"default",{dismissible:!1,timeout:!1})}),(t,l)=>{const $=c("p-button"),z=c("p-tabs"),A=c("p-layout-well"),J=c("p-layout-default");return n(),a(J,{class:"work-queue"},{header:s(()=>[e(u)?(n(),a(e(H),{key:0,"work-queue":e(u),onUpdate:e(_).refresh,onDelete:P},null,8,["work-queue","onUpdate"])):r("",!0)]),default:s(()=>[i(A,{class:"work-queue__body"},{header:s(()=>[i(e(K),{command:e(x),title:"Work queue is ready to go!",subtitle:"Work queues define the work to be done and agents poll a specific work queue for new work."},null,8,["command"])]),well:s(()=>[e(u)?(n(),a(e(g),{key:0,alternate:"","work-queue":e(u)},null,8,["work-queue"])):r("",!0)]),default:s(()=>[i(z,{selected:d.value,"onUpdate:selected":l[1]||(l[1]=k=>d.value=k),tabs:e(C)},{details:s(()=>[e(u)?(n(),a(e(g),{key:0,"work-queue":e(u)},null,8,["work-queue"])):r("",!0)]),"upcoming-runs":s(()=>[X("div",ne,[e(u)?(n(),a(e(Y),{key:0,"work-queue":e(u)},null,8,["work-queue"])):r("",!0),e(m)?(n(),a($,{key:1,secondary:"",class:"work-queue__active-runs-button",onClick:F},{default:s(()=>[ee(" Show active runs ")]),_:1})):r("",!0)])]),runs:s(()=>[i(e(ue),{states:w.value,"onUpdate:states":l[0]||(l[0]=k=>w.value=k),"flow-run-filter":e(B)},null,8,["states","flow-run-filter"])]),_:1},8,["selected","tabs"])]),_:1})]),_:1})}}});export{we as default};
