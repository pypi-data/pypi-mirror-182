import*as k from"../__snowpack__/env.js";import e,{Suspense as j,useCallback as w,useEffect as o,useMemo as v}from"../__snowpack__/pkg/react.js";import{Redirect as x,Route as i,BrowserRouter as T,Switch as y,useLocation as R}from"../__snowpack__/pkg/react-router-dom.js";import{THEME as S,matchMedia as p}from"./utils/theme.js";import{actions as N,selectors as P}from"./store/index.js";import{headerHeight as _,position as b,size as B,zIndexes as C}from"./utils/style.js";import{useDispatch as L,useSelector as A}from"../__snowpack__/pkg/react-redux.js";import H from"./components/ErrorBoundary.js";import u from"./pages/error.js";import{Helmet as I}from"../__snowpack__/pkg/react-helmet.js";import d from"../__snowpack__/pkg/nprogress.js";import M from"./components/Navbar.js";import{SWRConfig as O}from"../__snowpack__/pkg/swr.js";import{ToastContainer as $}from"../__snowpack__/pkg/react-toastify.js";import{fetcher as z}from"./utils/fetch.js";import f from"./routes/index.js";import h from"../__snowpack__/pkg/styled-components.js";import{useTranslation as D}from"../__snowpack__/pkg/react-i18next.js";const g=k.SNOWPACK_PUBLIC_BASE_URI,U=h.main`
    padding-top: ${_};
`,V=h.header`
    z-index: ${C.header};

    ${B(_,"100%")}
    ${b("fixed",0,0,null,0)}
`,s=f.find(t=>t.default),W=f.reduce((t,r)=>(r.children?t.push(...r.children):t.push(r),t),[]),K=()=>(o(()=>(d.start(),()=>{d.done()}),[]),null),F=()=>{const t=R();return o(()=>{window._hmt.push(["_trackPageview",g+t.pathname])},[t.pathname]),null},q=()=>{var m;const{t,i18n:r}=D("errors"),E=v(()=>r.language?r.dir(r.language):"",[r]),l=L(),c=A(P.theme.selected),a=w(n=>{c==="auto"&&l(N.theme.setTheme(n.matches?"dark":"light"))},[l,c]);return o(()=>{if(!S)return p.addEventListener("change",a),()=>{p.removeEventListener("change",a)}},[a]),e.createElement("div",{className:"app"},e.createElement(I,{defaultTitle:"VisualDL",titleTemplate:"%s - VisualDL"},e.createElement("html",{lang:r.language,dir:E})),e.createElement(O,{value:{fetcher:z,revalidateOnFocus:!1,revalidateOnReconnect:!1}},e.createElement(U,null,e.createElement(T,{basename:g||"/"},e.createElement(F,null),e.createElement(V,null,e.createElement(M,null)),e.createElement(H,{fallback:e.createElement(u,null)},e.createElement(j,{fallback:e.createElement(K,null)},e.createElement(y,null,e.createElement(x,{exact:!0,from:"/",to:(m=s==null?void 0:s.path)!=null?m:"/index"}),W.map(n=>e.createElement(i,{key:n.id,path:n.path,component:n.component})),e.createElement(i,{path:"*"},e.createElement(u,{title:t("errors:page-not-found")}))))))),e.createElement($,null)))};export default q;
